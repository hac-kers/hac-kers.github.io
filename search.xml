<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>二分(算法)</title>
      <link href="/2023/10/23/er-fen-suan-fa/"/>
      <url>/2023/10/23/er-fen-suan-fa/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.acwing.com/problem/content/791/">原题</a></p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>注意：如果写之前不考虑好想要查找的是什么，十有八九会是死循环或者查找错误，就算侥幸写对了也只是运气好而已！！！</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm&gt;</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">1e5</span><span class="token punctuation">;</span><span class="token keyword">int</span> n<span class="token punctuation">,</span>q<span class="token punctuation">,</span>qq<span class="token punctuation">;</span><span class="token keyword">int</span> num<span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    cin <span class="token operator">&gt;&gt;</span> n <span class="token operator">&gt;&gt;</span> q<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        cin <span class="token operator">&gt;&gt;</span> num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment">//cout &lt;&lt; num[i];</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> q<span class="token punctuation">;</span> i <span class="token operator">++</span> <span class="token punctuation">)</span>    <span class="token punctuation">{</span>        cin <span class="token operator">&gt;&gt;</span> qq<span class="token punctuation">;</span>        <span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> r <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//此处定义说明将查找的空间定为左闭右闭，与下面作对比</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>l <span class="token operator">&lt;</span> r<span class="token punctuation">)</span>         <span class="token punctuation">{</span>            <span class="token keyword">int</span> mid <span class="token operator">=</span> l <span class="token operator">+</span> r <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;</span> qq<span class="token punctuation">)</span> l <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> r <span class="token operator">=</span> mid<span class="token punctuation">;</span>            <span class="token comment">//cout &lt;&lt; l;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>num<span class="token punctuation">[</span>l<span class="token punctuation">]</span> <span class="token operator">!=</span> qq<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-1 -1\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">int</span> l1 <span class="token operator">=</span> l<span class="token punctuation">,</span> r1 <span class="token operator">=</span> n<span class="token punctuation">;</span><span class="token comment">//此处定义说明将查找的空间定为左闭右开</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>l1 <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> r1<span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">int</span> mid <span class="token operator">=</span> l1 <span class="token operator">+</span> r1 <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>num<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> qq<span class="token punctuation">)</span> l1 <span class="token operator">=</span> mid<span class="token punctuation">;</span>            <span class="token keyword">else</span> r1 <span class="token operator">=</span> mid<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d %d\n"</span><span class="token punctuation">,</span> l<span class="token punctuation">,</span> l1<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">/* 暴力o(n^2)        //cout &lt;&lt; qq;        int l=-1,r=-1;        for (int j = 0; j &lt; n; j ++ )        {            if (num[j] &gt;= qq)            {                if (num[j] == qq) l = j;                else l = -1;                break;            }        }         for (int j = n-1; j &gt; -1; j -- )        {            if (num[j] &lt;= qq)            {                if (num[j] == qq) r = j;                else r = -1;                break;            }        }        printf("%d %d\n",l,r);        */</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>35行定为左闭右开 [l1,r1)，故循环判断需为 l1 + 1 &lt; r1。为什么得这样设置？因为如果左闭右闭，判断循环会变成 l1 &lt; r1，这种不适用，寻找答案在左端，并且左端更新不能赋值mid+1的情况(寻找最右端的正确答案)，这个时候如果右端-左端=1，即区间大小为2，即 l1+1 = r1 ，mid = l1，会陷入一直死循环(因为这个时候mid永远等于左端即 mid = l1，然后 l1有符合条件一直循环)。所以左闭右开 [l1,r1)可以解决当 l1+1 = r1，然后mid = l1，再更新只能是 l1 = mid，不能是 l1 = mid + 1的情况。</p><p>当然也可以直接修改 “l1+1 = r1，然后mid = l1，再更新只能是 l1 = mid，不能是 l1 = mid + 1”这里面的一种情况使得左闭右闭不会循环，那就是使得mid = r1就行了，并竟左闭右闭时r1更新是 r1= mid-1，只需要mid = l1 + r1 + 1 &gt;&gt; 1即可。如下：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">while</span> <span class="token punctuation">(</span>l1 <span class="token operator">&lt;</span> r1<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> mid <span class="token operator">=</span> l1 <span class="token operator">+</span> r1 <span class="token operator">+</span> <span class="token number">1</span><span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>num<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> qq<span class="token punctuation">)</span> l1 <span class="token operator">=</span> mid<span class="token punctuation">;</span>    <span class="token keyword">else</span> r1 <span class="token operator">=</span> mid <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>此类二分保证不死循环，保证左端+1=右端时，mid所在的那一端符合更新条件时不能自我更新(mid所在的那一端 = mid)，而是mid-1或者mid+1 赋值给那一端，可以通过修改mid所在另一端或者一端由闭区间改开区间则不会出现左端+1=右端情况出现即可</p><h2 id="参考题解"><a href="#参考题解" class="headerlink" title="参考题解"></a>参考题解</h2><p><a href="https://www.acwing.com/solution/content/3338/">参考题解</a></p>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
          <category> 二分 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
            <tag> 二分 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LaTex写论文阅读笔记_文档结构</title>
      <link href="/2023/10/21/latex-xie-lun-wen-yue-du-bi-ji-wen-dang-jie-gou/"/>
      <url>/2023/10/21/latex-xie-lun-wen-yue-du-bi-ji-wen-dang-jie-gou/</url>
      
        <content type="html"><![CDATA[<h2 id="文档结构"><a href="#文档结构" class="headerlink" title="文档结构"></a>文档结构</h2><h3 id="基本要素"><a href="#基本要素" class="headerlink" title="基本要素"></a>基本要素</h3><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">[</span>a4paper,12pt<span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token keyword">article</span><span class="token punctuation">}</span><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span>A sentence of text.<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>\documentclass</code> 命令必须出现在每个 LaTeX 文档的开头。花括号内的文本指定了文档的类型。<strong>article</strong> 文档类型适合较短的文章，比如期刊文章和短篇报告。其他文档类型包括 <strong>report</strong>（适用于更长的多章节的文档，比如博士生论文），<strong>proc</strong>（会议论文集），<strong>book</strong> 和 <strong>beamer</strong>。方括号内的文本指定了一些选项——示例中它设置纸张大小为 A4，主要文字大小为 12pt。</p><p><code>\begin{document}</code> 和 <code>\end{document}</code> 命令将你的文本内容包裹起来。任何在 <code>\begin{documnet}</code> 之前的文本都被视为前导命令，会影响整个文档。任何在 <code>\end{document}</code> 之后的文本都会被忽视。</p><p>空行不是必要的，但它可以让长的文档更易读。</p><h3 id="添加文档标题"><a href="#添加文档标题" class="headerlink" title="添加文档标题"></a>添加文档标题</h3><p><code>\maketitle</code> 命令可以给文档创建标题。你需要指定文档的标题。如果没有指定日期，就会使用现在的时间，作者是可选的。</p><p>在 <code>\begin{document}</code> 和 命令后紧跟着输入以下文本：</p><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\title</span><span class="token punctuation">{</span>My First Document<span class="token punctuation">}</span><span class="token function selector">\author</span><span class="token punctuation">{</span>My Name<span class="token punctuation">}</span><span class="token function selector">\date</span><span class="token punctuation">{</span><span class="token function selector">\today</span><span class="token punctuation">}</span><span class="token function selector">\maketitle</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>你的文档现在长成了这样：</p><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">[</span>a4paper,12pt<span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token keyword">article</span><span class="token punctuation">}</span><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span class="token function selector">\title</span><span class="token punctuation">{</span>My First Document<span class="token punctuation">}</span><span class="token function selector">\author</span><span class="token punctuation">{</span>My Name<span class="token punctuation">}</span><span class="token function selector">\date</span><span class="token punctuation">{</span><span class="token function selector">\today</span><span class="token punctuation">}</span><span class="token function selector">\maketitle</span>A sentence of text.<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>要点笔记：</p><ul><li><code>\today</code> 是插入当前时间的命令。你也可以输入一个不同的时间，比如 <code>\date{November 2013}</code>。</li><li><strong>article</strong> 文档的正文会紧跟着标题之后在同一页上排版。<strong>report</strong> 会将标题置为单独的一页。</li></ul><h3 id="章节"><a href="#章节" class="headerlink" title="章节"></a>章节</h3><p>如果需要的话，你可能想将你的文档分为章（Chatpers）、节（Sections）和小节（Subsections）。下列分节命令适用于 <strong>article</strong> 类型的文档：</p><ul><li><code>\section{...}</code></li><li><code>\subsection{...}</code></li><li><code>\subsubsection{...}</code></li><li><code>\paragraph{...}</code></li><li><code>\subparagraph{...}</code></li></ul><p>花括号内的文本表示章节的标题。对于 <strong>report</strong> 和 <strong>book</strong> 类型的文档我们还支持 <code>\chapter{...}</code> 的命令。</p><p>将 “A sentence of text.” 替换为以下文本：</p><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">Introduction</span><span class="token punctuation">}</span>This is the introduction.<span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">Methods</span><span class="token punctuation">}</span><span class="token function selector">\subsection</span><span class="token punctuation">{</span><span class="token headline class-name">Stage 1</span><span class="token punctuation">}</span>The first part of the methods.<span class="token function selector">\subsection</span><span class="token punctuation">{</span><span class="token headline class-name">Stage 2</span><span class="token punctuation">}</span>The second part of the methods.<span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">Results</span><span class="token punctuation">}</span>Here are my results.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>你的文档会变成</p><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">[</span>a4paper,12pt<span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token keyword">article</span><span class="token punctuation">}</span><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span class="token function selector">\title</span><span class="token punctuation">{</span>My First Document<span class="token punctuation">}</span><span class="token function selector">\author</span><span class="token punctuation">{</span>My Name<span class="token punctuation">}</span><span class="token function selector">\date</span><span class="token punctuation">{</span><span class="token function selector">\today</span><span class="token punctuation">}</span><span class="token function selector">\maketitle</span><span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">Introduction</span><span class="token punctuation">}</span>This is the introduction.<span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">Methods</span><span class="token punctuation">}</span><span class="token function selector">\subsection</span><span class="token punctuation">{</span><span class="token headline class-name">Stage 1</span><span class="token punctuation">}</span>The first part of the methods.<span class="token function selector">\subsection</span><span class="token punctuation">{</span><span class="token headline class-name">Stage 2</span><span class="token punctuation">}</span>The second part of the methods.<span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">Results</span><span class="token punctuation">}</span>Here are my results.<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>生成PDF 文档。应该是长这样的</p><p><img src="/2023/10/21/latex-xie-lun-wen-yue-du-bi-ji-wen-dang-jie-gou/image-20231021160318989.png"></p><h3 id="创建标签"><a href="#创建标签" class="headerlink" title="创建标签"></a>创建标签</h3><p>你可以对任意章节命令创建标签，这样他们可以在文档的其他部分被引用。使用 <code>\label{labelname}</code> 对章节创建标签。然后输入 <code>\ref{labelname}</code> 或者 <code>\pageref{labelname}</code> 来引用对应的章节。</p><p>在 <code>\subsection{Stage 1}</code> 下面另起一行，输入 <code>\label{sec1}</code>。<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="\rightarrow"> 在 <strong>Results</strong> 章节输入 <code>Referring to section \ref{sec1} on page \pageref{sec1}</code>。</p><p>你的文档会变成这样：</p><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">[</span>a4paper,12pt<span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token keyword">article</span><span class="token punctuation">}</span><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span class="token function selector">\title</span><span class="token punctuation">{</span>My First Document<span class="token punctuation">}</span><span class="token function selector">\author</span><span class="token punctuation">{</span>My Name<span class="token punctuation">}</span><span class="token function selector">\date</span><span class="token punctuation">{</span><span class="token function selector">\today</span><span class="token punctuation">}</span><span class="token function selector">\maketitle</span><span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">Introduction</span><span class="token punctuation">}</span>This is the introduction.<span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">Methods</span><span class="token punctuation">}</span><span class="token function selector">\subsection</span><span class="token punctuation">{</span><span class="token headline class-name">Stage 1</span><span class="token punctuation">}</span><span class="token function selector">\label</span><span class="token punctuation">{</span><span class="token keyword">sec1</span><span class="token punctuation">}</span>The first part of the methods.<span class="token function selector">\subsection</span><span class="token punctuation">{</span><span class="token headline class-name">Stage 2</span><span class="token punctuation">}</span>The second part of the methods.<span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">Results</span><span class="token punctuation">}</span>Here are my results. Referring to section <span class="token function selector">\ref</span><span class="token punctuation">{</span><span class="token keyword">sec1</span><span class="token punctuation">}</span> on page <span class="token function selector">\pageref</span><span class="token punctuation">{</span>sec1<span class="token punctuation">}</span><span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>编译并检查 PDF 文档（可能需要连续编译两次）</p><p><img src="/2023/10/21/latex-xie-lun-wen-yue-du-bi-ji-wen-dang-jie-gou/image-20231021161758048.png"></p><p>在LaTeX中，创建标签（或者说标记）是为了能够在文档中引用特定位置或对象的标识符。标签可以用于交叉引用、引用图表、公式、章节等内容，以及创建内部链接和目录。</p><p>以下是一些使用标签的常见场景和用途：</p><ol><li><p>交叉引用：标签允许你在文档的其他位置引用特定内容。例如，在文中引用某个章节、图表或公式，可以使用<code>\label{}</code>命令为其创建一个标签，然后使用<code>\ref{}</code>命令在其他位置引用该标签所关联的内容。</p></li><li><p>引用图表和公式：使用标签可以方便地引用文档中的图表和公式。通过为图表和公式添加标签，你可以使用<code>\ref{}</code>命令在文中其他位置引用它们，而不需要手动编写相应的编号。</p></li><li><p>创建内部链接：你可以使用标签创建内部链接，以便读者可以点击链接跳转到文档的其他位置。这可以增加文档的可导航性和易读性。标签可以与<code>\hyperref[]</code>命令结合使用，创建包含链接的文字或图标，在使用<code>\hyperref[]</code>命令时，它会自动创建一个超链接，指向标签所在位置。你可以在文本中的任何位置使用<code>\hyperref[]</code>命令，以创建链接到其他部分的超链接。</p><p>请注意，使用<code>\hyperref[]</code>命令之前，通常需要对文档进行多次编译，以确保超链接被正确解析和显示。</p></li></ol><p>总之，标签是在LaTeX文档中定义和引用特定位置或对象的一种方式。它们提供了方便的跳转和引用机制，使得文档结构更加清晰、易于导航和引用。</p><h3 id="生成目录（TOC）"><a href="#生成目录（TOC）" class="headerlink" title="生成目录（TOC）"></a>生成目录（TOC）</h3><p>如果你使用分节命令，那么可以容易地生成一个目录。使用 <code>\tableofcontents</code> 在文档中创建目录。通常我们会在标题的后面建立目录。</p><p>你可能也想也想更改页码为罗马数字（i,ii,iii）。这会确保文档的正文从第 1 页开始。页码可以使用 <code>\pagenumbering{...}</code> 在阿拉伯数字和罗马数字见切换。</p><p>在 <code>\maketitle</code> 之后输入以下内容：</p><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\pagenumbering</span><span class="token punctuation">{</span>roman<span class="token punctuation">}</span><span class="token function selector">\tableofcontents</span><span class="token function selector">\newpage</span><span class="token function selector">\pagenumbering</span><span class="token punctuation">{</span>arabic<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><code>\newpage</code> 命令会另起一个页面，这样我们就可以看到 <code>\pagenumbering</code> 命令带来的影响了。你的文档的前 14 行长这样：</p><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">[</span>a4paper,12pt<span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token keyword">article</span><span class="token punctuation">}</span><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span class="token function selector">\title</span><span class="token punctuation">{</span>My First Document<span class="token punctuation">}</span><span class="token function selector">\author</span><span class="token punctuation">{</span>My Name<span class="token punctuation">}</span><span class="token function selector">\date</span><span class="token punctuation">{</span><span class="token function selector">\today</span><span class="token punctuation">}</span><span class="token function selector">\maketitle</span><span class="token function selector">\pagenumbering</span><span class="token punctuation">{</span>roman<span class="token punctuation">}</span><span class="token function selector">\tableofcontents</span><span class="token function selector">\newpage</span><span class="token function selector">\pagenumbering</span><span class="token punctuation">{</span>arabic<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2023/10/21/latex-xie-lun-wen-yue-du-bi-ji-wen-dang-jie-gou/image-20231021182141620.png"></p><p>第二页：</p><p><img src="/2023/10/21/latex-xie-lun-wen-yue-du-bi-ji-wen-dang-jie-gou/image-20231021182212262.png"></p><h3 id="itemize环境列举无序项目列表"><a href="#itemize环境列举无序项目列表" class="headerlink" title="itemize环境列举无序项目列表"></a>itemize环境列举无序项目列表</h3><p>在 LaTeX 中，可以使用 <code>itemize</code> 环境来创建项目列表。<code>itemize</code> 环境会自动为每个项目生成一个项目符号，并将它们垂直对齐。</p><p>下面是一个示例，展示了如何使用 <code>itemize</code> 环境创建一个简单的项目列表：</p><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">{</span><span class="token keyword">article</span><span class="token punctuation">}</span><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">itemize</span><span class="token punctuation">}</span>  <span class="token function selector">\item</span> 第一项  <span class="token function selector">\item</span> 第二项  <span class="token function selector">\item</span> 第三项<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">itemize</span><span class="token punctuation">}</span><span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们使用了 <code>itemize</code> 环境，并在其中列举了三个项目。每个项目都使用 <code>\item</code> 命令开始，后面是项目的内容。</p><p>当你编译这个示例时，LaTeX 会生成一个带有项目符号的垂直列表，如下所示：</p><ul><li>第一项</li><li>第二项</li><li>第三项</li></ul><p>你可以根据需要添加或删除项目，<code>itemize</code> 环境会自动调整项目符号和对齐方式。</p><p>除了默认的项目符号（通常是一个实心圆点），你还可以通过自定义 <code>itemize</code> 环境的样式进行更改。例如，你可以使用 <code>\renewcommand</code> 命令来重新定义项目符号的样式。以下是一个示例，演示如何将项目符号更改为破折号：</p><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">{</span><span class="token keyword">article</span><span class="token punctuation">}</span><span class="token function selector">\renewcommand</span><span class="token punctuation">{</span><span class="token function selector">\labelitemi</span><span class="token punctuation">}</span><span class="token punctuation">{</span>--<span class="token punctuation">}</span><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">itemize</span><span class="token punctuation">}</span>  <span class="token function selector">\item</span> 第一项  <span class="token function selector">\item</span> 第二项  <span class="token function selector">\item</span> 第三项<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">itemize</span><span class="token punctuation">}</span><span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个示例中，我们使用 <code>\renewcommand</code> 重新定义了 <code>\labelitemi</code> 命令，将项目符号更改为破折号。可以根据需要调整样式。</p><h3 id="enumerate环境列举有序项目列表"><a href="#enumerate环境列举有序项目列表" class="headerlink" title="enumerate环境列举有序项目列表"></a>enumerate环境列举有序项目列表</h3><p>前者<code>itemize</code>：用于创建无序项目列表，每个项目通常以实心圆点作为项目符号。enumerate用于创建有序项目列表，每个项目通常以数字作为项目符号。</p><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">enumerate</span><span class="token punctuation">}</span>  <span class="token function selector">\item</span> 第一项  <span class="token function selector">\item</span> 第二项  <span class="token function selector">\item</span> 第三项<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">enumerate</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="description-环境描述性列表"><a href="#description-环境描述性列表" class="headerlink" title="description 环境描述性列表"></a>description 环境描述性列表</h3><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">description</span><span class="token punctuation">}</span>  <span class="token function selector">\item</span><span class="token punctuation">[</span>项目一<span class="token punctuation">]</span> 这是项目一的描述。  <span class="token function selector">\item</span><span class="token punctuation">[</span>项目二<span class="token punctuation">]</span> 这是项目二的描述。  <span class="token function selector">\item</span><span class="token punctuation">[</span>项目三<span class="token punctuation">]</span> 这是项目三的描述。<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">description</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在 <code>description</code> 环境中，项目符号通常是项目的标题或标签，而不是简单的符号或数字。每个项目都可以用方括号包围的文本来定义项目符号。</p><h3 id="页码设置相关的命令"><a href="#页码设置相关的命令" class="headerlink" title="页码设置相关的命令"></a>页码设置相关的命令</h3><p>在LaTex中，与页码和页面设置相关的命令有\pagestyle{type}，\thispagestyle{type}，setcounter{page}{number}，\pagenumbering{style}。<br>\pagestyle{type}和\thispagestyle{type}命令用于设置页面样式（页眉和页脚）。\pagestyle{type}和\thispagestyle{type}的主要区别在于\pagestyle{type}对后续所有页面都有效，而\thispagestyle{type}仅仅对当前页面有效。在LaTeX中，默认提供了以下四种页面样式：</p><ul><li>empty - 没有页眉和页脚</li><li>plain - 没有页眉，页脚包含一个居中的页码</li><li>headings - 没有页脚，页眉包含章/节或者字节的名字和页码，可以使用 <code>\pagestyle{headings}</code> 命令来启用这个页面风格。</li><li>myheadings - 没有页脚，页眉包含有页码可以使用 <code>\markboth{left}{right}</code> 命令来设置自定义的页眉内容，并使用 <code>\pagestyle{myheadings}</code> 命令来启用这个页面风格。</li></ul><p>你想在每一页的底部中央显示页码，可以在文档的导言区添加以下命令：</p><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\pagestyle</span><span class="token punctuation">{</span>plain<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>默认情况下，页码从第一页开始（通常是包含标题页的）并且以阿拉伯数字形式显示（例如：1，2，3 …）。页码的编号也可以通过\setcounter{page}{number}命令手动设置，需要注意的是，手动设置可能会导致重复的页码出现。<br>\pagenumbering{style}命令则用于改变页码的显示风格。LaTeX中页码风格包含以下五类：</p><ul><li>arabic - 阿拉伯数字</li><li>roman - 小写的罗马数字</li><li>Roman - 大写的罗马数字</li><li>alph - 小写的字符形式</li><li>Alph -大写的字符形式</li></ul><pre class="line-numbers language-latex" data-language="latex"><code class="language-latex"><span class="token function selector">\documentclass</span><span class="token punctuation">{</span><span class="token keyword">article</span><span class="token punctuation">}</span><span class="token function selector">\usepackage</span><span class="token punctuation">{</span><span class="token keyword">fontspec, xunicode, xlextra</span><span class="token punctuation">}</span><span class="token function selector">\usepackage</span><span class="token punctuation">{</span><span class="token keyword">xeCJK</span><span class="token punctuation">}</span><span class="token function selector">\title</span><span class="token punctuation">{</span><span class="token function selector">\LaTeX</span> 页码设置<span class="token punctuation">}</span><span class="token function selector">\author</span><span class="token punctuation">{</span>Japinli<span class="token punctuation">}</span><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span class="token function selector">\maketitle</span><span class="token function selector">\thispagestyle</span><span class="token punctuation">{</span>empty<span class="token punctuation">}</span> <span class="token comment">% 当前页不显示页码</span><span class="token function selector">\newpage</span><span class="token function selector">\pagestyle</span><span class="token punctuation">{</span>headings<span class="token punctuation">}</span><span class="token function selector">\setcounter</span><span class="token punctuation">{</span>page<span class="token punctuation">}</span><span class="token punctuation">{</span>1<span class="token punctuation">}</span><span class="token function selector">\pagenumbering</span><span class="token punctuation">{</span>Roman<span class="token punctuation">}</span><span class="token function selector">\section*</span><span class="token punctuation">{</span><span class="token headline class-name">前言</span><span class="token punctuation">}</span>学习如何在<span class="token function selector">\LaTeX</span> 中设置页码。<span class="token function selector">\newpage</span><span class="token function selector">\tableofcontents</span><span class="token function selector">\newpage</span><span class="token function selector">\setcounter</span><span class="token punctuation">{</span>page<span class="token punctuation">}</span><span class="token punctuation">{</span>1<span class="token punctuation">}</span><span class="token function selector">\pagenumbering</span><span class="token punctuation">{</span>arabic<span class="token punctuation">}</span><span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">页码风格</span><span class="token punctuation">}</span><span class="token function selector">\LaTeX</span> 中包含五种页码风格，分别是<span class="token function selector">\emph</span><span class="token punctuation">{</span>arabic<span class="token punctuation">}</span>，<span class="token function selector">\emph</span><span class="token punctuation">{</span>roman<span class="token punctuation">}</span>，<span class="token function selector">\emph</span><span class="token punctuation">{</span>Roman<span class="token punctuation">}</span>，<span class="token function selector">\emph</span><span class="token punctuation">{</span>alph<span class="token punctuation">}</span>和<span class="token function selector">\emph</span><span class="token punctuation">{</span>Alph<span class="token punctuation">}</span>。<span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">页码风格说明</span><span class="token punctuation">}</span><span class="token function selector">\emph</span><span class="token punctuation">{</span>arabic<span class="token punctuation">}</span>代表阿拉伯数字类型。<span class="token function selector">\emph</span><span class="token punctuation">{</span>roman<span class="token punctuation">}</span>代表小写的罗马数字类型。<span class="token function selector">\emph</span><span class="token punctuation">{</span>Roman<span class="token punctuation">}</span>代表大写的罗马数字类型。<span class="token function selector">\emph</span><span class="token punctuation">{</span>alph<span class="token punctuation">}</span>代表小写的字符类型。<span class="token function selector">\emph</span><span class="token punctuation">{</span>Alph<span class="token punctuation">}</span>代表大写的字符类型。<span class="token function selector">\section</span><span class="token punctuation">{</span><span class="token headline class-name">页码风格设置</span><span class="token punctuation">}</span>为了改变页码的风格，可以使用<span class="token function selector">\emph</span><span class="token punctuation">{</span><span class="token function selector">\textbackslash</span> pagenumbering<span class="token function selector">\{</span>sytle<span class="token function selector">\}</span><span class="token punctuation">}</span>命令设置。<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://blog.csdn.net/japinli/article/details/51418977">本节参考</a></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://oi-wiki.org/tools/latex/">LaTeX 入门</a></p><p><a href="https://mdnice.com/writing/285dc7d7cfd54d89b0378b4e08e8c006">vs code 配置latex环境保姆级配置教程（双系统）</a></p><p><a href="https://zhuanlan.zhihu.com/p/110451310">MikTex + VS Code 配置教程</a></p><p><a href="https://www.writelatex.com/signup">在线latex 并生成pdf网站：writelatex</a></p>]]></content>
      
      
      <categories>
          
          <category> LaTex </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LaTex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>软件安全实验_1</title>
      <link href="/2023/10/20/ruan-jian-an-quan-shi-yan-1/"/>
      <url>/2023/10/20/ruan-jian-an-quan-shi-yan-1/</url>
      
        <content type="html"><![CDATA[<h1 id="实验1-磁盘结构与文件系统"><a href="#实验1-磁盘结构与文件系统" class="headerlink" title="实验1 磁盘结构与文件系统"></a>实验1 磁盘结构与文件系统</h1><h2 id="实验目的"><a href="#实验目的" class="headerlink" title="实验目的"></a>实验目的</h2><ul><li><p>加深对 FAT32 分区及文件系统格式的理解</p></li><li><p>掌握借助 WinHex 等工具手工定位磁盘文件数据的技能</p></li><li><p>通过开发一个磁盘文件数据提取工具，强化编程实践能力。</p></li></ul><h2 id="实验内容"><a href="#实验内容" class="headerlink" title="实验内容"></a>实验内容</h2><h3 id="内容一：手工定位和提取-FAT32-分区中的文件数据"><a href="#内容一：手工定位和提取-FAT32-分区中的文件数据" class="headerlink" title="内容一：手工定位和提取 FAT32 分区中的文件数据"></a>内容一：手工定位和提取 FAT32 分区中的文件数据</h3><p>在 FAT32 分区下创建一个不小于 10K 的文件，文件名称用本组组长姓名的拼</p><p>音命名。根据课上介绍的 FAT32 分区及文件系统知识，必要时自行上网查阅</p><p>相关资料，借助 WinHex 或其它十六进制工具，以手工方式从磁盘中逐一找</p><p>到该文件的各个存储扇区，复制其中的有效内容，并拼接组合成一个与原文</p><p>档内容相同的完整文档。</p><p>要求：操作过程描述中，要展示带有组长姓名字样的截图。</p><h3 id="内容二：编程实现“内容一”的全过程"><a href="#内容二：编程实现“内容一”的全过程" class="headerlink" title="内容二：编程实现“内容一”的全过程"></a>内容二：编程实现“内容一”的全过程</h3><p>输入：某个文件（A）的路径</p><p>输出：</p><p>（1）该文件的短文件名目录项信息</p><p>（2）该文件的簇链</p><p>（3）根据上述的文件簇链，从磁盘上提取数据并拼接而得的新文件（B）</p><p>（4）文件 A 与文件 B 内容的比较结果（要求二者完全一致）</p><h2 id="实验工具和编程语言"><a href="#实验工具和编程语言" class="headerlink" title="实验工具和编程语言"></a>实验工具和编程语言</h2><p>实验工具：Winhex、VSCode</p><p>编程语言：Python 3.9.12</p><h2 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h2><h3 id="内容一："><a href="#内容一：" class="headerlink" title="内容一："></a>内容一：</h3><p>提前在新分区的 F 盘上创建 zqb.txt，并填入内容，文件大小 10K。</p><p>打开 Winhex，并且打开 F 磁盘。如下图，可得 BPB 中的重要字段：</p><p>·每扇区字节数：0x0200 </p><p>·每簇扇区数：0x08 </p><p>·保留扇区数：0x100E </p><p>·FAT 的个数：2 </p><p>·每个 FAT 占用的扇区数：0x000007F9 </p><p>·BPB_RootClus（根目录首簇号）：0x02</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020110710251.png"></p><p>故 FirstSectorofRoot=保留扇区数 + (FAT 个数 * 每个 FAT 所占扇区数)</p><p>=0x100E+(2*0x07F9)=0x2000</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020110815637.png"></p><p>定位到 0x2000*0x200=0x400000 根目录处，找到 ZQB.TXT 在 0x4000E0 处。</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020110856194.png"></p><p>参考此表可得</p><p>·起始簇号的高 16 位=0x0001 ·起始簇号的低 16 位=0x022A</p><p>计算得起始簇号=0x0001022A</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020110934931.png"></p><p>定位到 FAT1，即保留扇区数<em>每扇区字节数=0x100E</em>0x0200=0x201c00</p><p>起始簇号=0x0001022A，簇大小 4B，故位于 4*0x0001022A+0x201c00=0x2424A8</p><p>故起始簇的下一簇为 0x0001022B，下一簇=0x0001022C，再下一个为</p><p>0x0FFFFFFF，即最后一簇。</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020111013371.png"></p><p>最后来定位文件，计算文件初始簇的偏移。根据下图的公式可得，</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020111057729.png"></p><p>文件某簇的偏移 = 根目录首簇偏移 + (文件某簇号 - 根目录首簇号)*每簇</p><p>扇区数</p><p>zqb.txt 文件初始簇的偏移</p><p>=0x400000+(0x0001022A-0x2)<em>8</em>0x200=0x10628000</p><p>可以发现，已经定位到 zqb.txt 文件。</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020111130607.png"></p><p>复制其中的有效内容拼接组合成一个与原文档内容相同的完整文档。</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020111203286.png"></p><p>最后可成功打开</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020111233613.png"></p><h3 id="内容二："><a href="#内容二：" class="headerlink" title="内容二："></a>内容二：</h3><h4 id="程序主要设计思路"><a href="#程序主要设计思路" class="headerlink" title="程序主要设计思路"></a>程序主要设计思路</h4><h5 id="路径分割，打开磁盘"><a href="#路径分割，打开磁盘" class="headerlink" title="路径分割，打开磁盘"></a>路径分割，打开磁盘</h5><p>将输入的绝对路径进行分割，分割成一个一个的子文件(不区分文件和目录，</p><p>因为在磁盘中，目录其实就是特殊的文件)。</p><p>例如，对于输入的路径 F:/lab/123/test.txt，会将其分割成[“F:”, “lab”, “123”,“test” ]</p><h5 id="读取磁盘"><a href="#读取磁盘" class="headerlink" title="读取磁盘"></a>读取磁盘</h5><p> BPB 中的数据，主要数据如下</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020111459118.png"></p><h5 id="读取目录项"><a href="#读取目录项" class="headerlink" title="读取目录项"></a>读取目录项</h5><p>读取目录项时，要注意长文件名的单独处理，对于文件名大于 8 字节或者</p><p>文件后缀大于 3 字节的为长文件名。</p><p>首先由公式：FAT32 分区根目录项=保留扇区大小+文件分配表大小*文件分配</p><p>表个数 定位到根目录项。</p><p>然后通过根目录可以读取到一级目录的目录项，然后就可以通过一个循环去</p><p>读取二级、三级等目录项。</p><p>最后找到最后一级目录项，然后定位文件的首簇号，再定位其簇链(实验一</p><p>已经说明)，最后就可以通过簇链定位文件内容。</p><h5 id="读取文件内容并写入新文件"><a href="#读取文件内容并写入新文件" class="headerlink" title="读取文件内容并写入新文件"></a>读取文件内容并写入新文件</h5><p>在第 3 步中，通过起始簇号可以在 FAT 中将文件的整个簇链找出来，然后就可以直接定位文件内容了。</p><p>读取文件内容时，要注意磁盘给文件分配存储空间时，是以簇为单位进行分配的。这也就是说文件的实际大小不一定就为操作系统给其分配的大小，所以这里在最后一簇时，要进行判断。 </p><h5 id="程序使用说明"><a href="#程序使用说明" class="headerlink" title="程序使用说明"></a>程序使用说明</h5><p>考虑到文件路径可能过长，所以只需要将文件路径替换成自己的路径即可，</p><p>注意文件路径应当是绝对路径，并且使用 “\” 进行分割，比如：F:/lab/123/test.txt</p><p>编程语句使用 python，所以无需编译，直接运行即可，如果出现语法错误，</p><p>可以是由于 python 版本导致，笔者使用的是 Python 3.9.12</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020111914045.png"></p><h5 id="程序测试结果"><a href="#程序测试结果" class="headerlink" title="程序测试结果"></a>程序测试结果</h5><p>注意，如果文件目录过深，分析过程可能比较长，请耐心等待</p><p>测试 1：</p><p>输入文件内容及其路径：路径包含 6 级目录，并且包含长文件名及短文件名</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020112526944.png"></p><p>输出结果其新文件内容：</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020112626290.png"></p><p>新旧文件对比：</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020112659991.png"></p><p>测试 2：</p><p>输入文件内容及其路径：文件在根目录下，为短文件</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020112757626.png"></p><p>输出结果：</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020112825361.png"></p><p>新旧文件对比：</p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020112858762.png"></p><p><img src="/2023/10/20/ruan-jian-an-quan-shi-yan-1/image-20231020112920773.png"></p><h4 id="程序代码"><a href="#程序代码" class="headerlink" title="程序代码"></a>程序代码</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token comment"># 打印二进制数据, 方便 debug</span><span class="token keyword">def</span> <span class="token function">binary_dump</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> length<span class="token operator">=</span><span class="token number">1000000000000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> i <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">" "</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n      "</span><span class="token operator">+</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">98</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">": "</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">&gt;=</span> length<span class="token punctuation">:</span> <span class="token keyword">break</span>        <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> i <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">32</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> i <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">": "</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">" "</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token comment"># 字符串转换为 16 进制数据</span><span class="token keyword">def</span> <span class="token function">str_to_hex</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">]</span><span class="token comment"># 将 16 进制按照指定大小端进行转换</span><span class="token keyword">def</span> <span class="token function">hex_to_num</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> endian<span class="token operator">=</span><span class="token string">"little"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    hex_num<span class="token punctuation">,</span> num <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span>    <span class="token keyword">if</span> endian <span class="token operator">==</span> <span class="token string">"big"</span><span class="token punctuation">:</span>        hex_num <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>hex_num<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment">#    print(hex_num)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>hex_num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        num <span class="token operator">|</span><span class="token operator">=</span> hex_num<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> num<span class="token comment"># 读取基本数据</span><span class="token keyword">def</span> <span class="token function">read_BPB</span><span class="token punctuation">(</span>disk<span class="token punctuation">)</span><span class="token punctuation">:</span>    DBR <span class="token operator">=</span> disk<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">'latin-1'</span><span class="token punctuation">)</span>    disk<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">#    print(DBR)</span><span class="token comment">#    binary_dump(DBR)</span>    DBR_hex <span class="token operator">=</span> str_to_hex<span class="token punctuation">(</span>DBR<span class="token punctuation">)</span>    byte_per_sector <span class="token operator">=</span> hex_to_num<span class="token punctuation">(</span>DBR_hex<span class="token punctuation">[</span><span class="token number">0xb</span><span class="token punctuation">:</span><span class="token number">0xb</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    sector_per_clust <span class="token operator">=</span> hex_to_num<span class="token punctuation">(</span>DBR_hex<span class="token punctuation">[</span><span class="token number">0xd</span><span class="token punctuation">:</span><span class="token number">0xd</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    saved_sector <span class="token operator">=</span> hex_to_num<span class="token punctuation">(</span>DBR_hex<span class="token punctuation">[</span><span class="token number">0xe</span><span class="token punctuation">:</span><span class="token number">0xe</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    fat_nums <span class="token operator">=</span> hex_to_num<span class="token punctuation">(</span>DBR_hex<span class="token punctuation">[</span><span class="token number">0x10</span><span class="token punctuation">:</span><span class="token number">0x10</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    sector_per_fat <span class="token operator">=</span> hex_to_num<span class="token punctuation">(</span>DBR_hex<span class="token punctuation">[</span><span class="token number">0x24</span><span class="token punctuation">:</span><span class="token number">0x24</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    root_clust_idx <span class="token operator">=</span> hex_to_num<span class="token punctuation">(</span>DBR_hex<span class="token punctuation">[</span><span class="token number">0x2c</span><span class="token punctuation">:</span><span class="token number">0x2c</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token triple-quoted-string string">"""    print("byte_per_sector: ", hex(byte_per_sector))    print("sector_per_clust: ", hex(sector_per_clust))    print("saved_sector: ", hex(saved_sector))    print("fat_nums: ", hex(fat_nums))    print("sector_per_fat: ", hex(sector_per_fat))    print("root_clust_idx: ", hex(root_clust_idx))    """</span>    <span class="token keyword">return</span> byte_per_sector<span class="token punctuation">,</span> sector_per_clust<span class="token punctuation">,</span> saved_sector<span class="token punctuation">,</span> fat_nums<span class="token punctuation">,</span> sector_per_fat<span class="token punctuation">,</span> root_clust_idx<span class="token comment"># 寻找目录项</span><span class="token keyword">def</span> <span class="token function">find_file_dir_entry</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> root_dir_entry_offset<span class="token punctuation">,</span> disk<span class="token punctuation">,</span> suffix<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> max_len <span class="token operator">=</span> <span class="token number">0x10000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    k <span class="token operator">=</span> <span class="token number">0</span>    <span class="token comment"># 短文件名</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">8</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>suffix<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">:</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            dentry <span class="token operator">=</span> disk<span class="token punctuation">.</span>read<span class="token punctuation">(</span>root_dir_entry_offset<span class="token operator">+</span><span class="token number">0x20</span><span class="token operator">*</span>k<span class="token punctuation">)</span>            disk<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token comment">#    print(dentry[-0x20:])</span>            dentry <span class="token operator">=</span> dentry<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">'latin-1'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0x20</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            k <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token comment">#    binary_dump(dentry)</span>        <span class="token comment">#    print("======================================")</span>        <span class="token comment">#    print(str(dentry[:len(filename)]))</span>        <span class="token comment">#    print(str(dentry[8:8+len(suffix)]))</span>        <span class="token comment">#    print(dentry[0])</span>            <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">(</span>dentry<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>                 <span class="token comment">#print("good")</span>                <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>suffix<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">or</span> <span class="token builtin">str</span><span class="token punctuation">(</span>dentry<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>suffix<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span>suffix<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token comment">#    print("good")</span>                    <span class="token keyword">break</span>            <span class="token keyword">if</span> k <span class="token operator">&gt;</span> max_len<span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">False</span>        <span class="token keyword">return</span> dentry<span class="token punctuation">,</span> <span class="token boolean">True</span>    <span class="token comment"># 长文件名</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        continue_flag <span class="token operator">=</span> <span class="token boolean">False</span>        idx <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span>        length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>suffix<span class="token punctuation">)</span>         dentry_num <span class="token operator">=</span> length <span class="token operator">//</span> <span class="token number">13</span> <span class="token operator">+</span> <span class="token number">1</span>        first_num <span class="token operator">=</span> length <span class="token operator">%</span> <span class="token number">13</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>suffix<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span> file_name <span class="token operator">=</span> filename<span class="token operator">+</span><span class="token string">"."</span><span class="token operator">+</span>suffix        <span class="token keyword">else</span><span class="token punctuation">:</span> file_name <span class="token operator">=</span> filename        file_name_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>dentry_num<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            file_name_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>file_name<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">13</span><span class="token punctuation">:</span>i<span class="token operator">*</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> first_num<span class="token punctuation">:</span> file_name_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>file_name<span class="token punctuation">[</span><span class="token punctuation">(</span>dentry_num<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">13</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        file_name_list <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>file_name_list<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token comment">#print(file_name_list)</span>        <span class="token comment">#print(first_num)</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> k <span class="token operator">&gt;</span> max_len<span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">False</span>            continue_flag <span class="token operator">=</span> <span class="token boolean">False</span>            dentrys_origin <span class="token operator">=</span> disk<span class="token punctuation">.</span>read<span class="token punctuation">(</span>root_dir_entry_offset<span class="token operator">+</span><span class="token number">0x20</span><span class="token operator">*</span><span class="token punctuation">(</span>k<span class="token operator">+</span>dentry_num<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            disk<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            dentrys_origin <span class="token operator">=</span> dentrys_origin<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">'latin-1'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0x20</span><span class="token operator">*</span><span class="token punctuation">(</span>dentry_num<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            <span class="token comment">#binary_dump(dentrys_origin)</span>            dentrys <span class="token operator">=</span> <span class="token punctuation">[</span>dentrys_origin<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">0x20</span><span class="token punctuation">:</span>i<span class="token operator">*</span><span class="token number">0x20</span><span class="token operator">+</span><span class="token number">0x20</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>dentry_num<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>dentrys<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> dentrys<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> str_to_hex<span class="token punctuation">(</span>dentrys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token comment">#print(dentry_num)</span>            <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>dentrys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xe5</span><span class="token punctuation">:</span>                k <span class="token operator">+=</span> <span class="token number">1</span>                <span class="token keyword">continue</span>            <span class="token keyword">if</span> first_num<span class="token punctuation">:</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>first_num<span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token comment">#print(str.upper(file_name_list[0][i]))</span>                    <span class="token comment">#print(str.upper(chr(int(dentrys[0][idx[i]], 16))))</span>                    <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>dentrys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span>file_name_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        continue_flag <span class="token operator">=</span> <span class="token boolean">True</span>                        <span class="token keyword">break</span>                   <span class="token comment">#else:</span>                        <span class="token comment">#print(str.upper(chr(int(dentrys[0][idx[i]], 16))), end="")</span>                        <span class="token comment">#print("good")</span>            <span class="token keyword">if</span> first_num<span class="token punctuation">:</span> m <span class="token operator">=</span> <span class="token number">1</span>             <span class="token keyword">else</span><span class="token punctuation">:</span> m <span class="token operator">=</span> <span class="token number">0</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> dentry_num<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>dentrys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span>file_name_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        continue_flag <span class="token operator">=</span> <span class="token boolean">True</span>                        <span class="token keyword">break</span>                    <span class="token comment">#else:</span>                        <span class="token comment">#print(str.upper(chr(int(dentrys[i][idx[j]], 16))), end="")</span>                        <span class="token keyword">if</span> continue_flag <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span>                 k <span class="token operator">+=</span> <span class="token number">1</span>                <span class="token keyword">continue</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token comment">#    binary_dump(dentrys_origin)</span>            <span class="token comment">#    print("good")</span>                <span class="token keyword">break</span>    <span class="token comment">#    print(dentrys)</span>    <span class="token comment">#    print(file_name)</span>    <span class="token comment">#    print(dentrys_origin)</span>    <span class="token comment">#    print(dentrys_origin[dentry_num*0x20:])</span>        <span class="token keyword">return</span> dentrys_origin<span class="token punctuation">[</span>dentry_num<span class="token operator">*</span><span class="token number">0x20</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token comment"># 通过目录项获取起始簇号</span><span class="token keyword">def</span> <span class="token function">get_clust_idx_and_file_size_by_dentry</span><span class="token punctuation">(</span>dentry<span class="token punctuation">)</span><span class="token punctuation">:</span>    dentry_hex <span class="token operator">=</span>  str_to_hex<span class="token punctuation">(</span>dentry<span class="token punctuation">)</span><span class="token comment">#    print(dentry_hex)</span>    high <span class="token operator">=</span> dentry_hex<span class="token punctuation">[</span><span class="token number">0x14</span><span class="token punctuation">:</span><span class="token number">0x14</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>    low <span class="token operator">=</span> dentry_hex<span class="token punctuation">[</span><span class="token number">0x1a</span><span class="token punctuation">:</span><span class="token number">0x1a</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>    clust_idx_hex <span class="token operator">=</span> low <span class="token operator">+</span> high<span class="token comment">#    print(high)</span><span class="token comment">#    print(low)</span><span class="token comment">#    print(clust_idx_hex)</span>    clust_idx <span class="token operator">=</span> hex_to_num<span class="token punctuation">(</span>clust_idx_hex<span class="token punctuation">)</span>    file_size <span class="token operator">=</span> hex_to_num<span class="token punctuation">(</span>dentry_hex<span class="token punctuation">[</span><span class="token number">0x1c</span><span class="token punctuation">:</span><span class="token number">0x1c</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#    print(hex(clust_idx))</span>    <span class="token keyword">return</span> clust_idx<span class="token punctuation">,</span> file_size<span class="token comment"># 通过起始簇号在 FAT 表中找出簇链</span><span class="token keyword">def</span> <span class="token function">get_clust_list_by_fat</span><span class="token punctuation">(</span>clust_idx<span class="token punctuation">,</span> fat_offset<span class="token punctuation">,</span> fat_size<span class="token punctuation">,</span> disk<span class="token punctuation">)</span><span class="token punctuation">:</span>    clust_idx_list<span class="token punctuation">,</span> flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">True</span>    fat <span class="token operator">=</span> disk<span class="token punctuation">.</span>read<span class="token punctuation">(</span>fat_offset<span class="token operator">+</span>fat_size<span class="token punctuation">)</span><span class="token punctuation">[</span>fat_offset<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">'latin-1'</span><span class="token punctuation">)</span>    disk<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">#    binary_dump(fat, 0x100)</span>    fat_hex <span class="token operator">=</span> str_to_hex<span class="token punctuation">(</span>fat<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token comment">#    print(hex(clust_idx))</span>        clust_idx_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>clust_idx<span class="token punctuation">)</span>        clust_idx <span class="token operator">=</span> hex_to_num<span class="token punctuation">(</span>fat_hex<span class="token punctuation">[</span>clust_idx<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">:</span>clust_idx<span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> clust_idx <span class="token operator">==</span> <span class="token number">0xffffff7</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"出现坏簇{0}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>clust_idx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">if</span> clust_idx <span class="token operator">==</span> <span class="token number">0xfffffff</span> <span class="token keyword">or</span> clust_idx <span class="token operator">==</span> <span class="token number">0xffffff8</span><span class="token punctuation">:</span> <span class="token keyword">break</span>        <span class="token keyword">if</span> clust_idx <span class="token operator">&gt;=</span> <span class="token number">2</span> <span class="token keyword">and</span> clust_idx <span class="token operator">&lt;=</span> <span class="token number">0xfffffef</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    <span class="token keyword">return</span> clust_idx_list<span class="token comment"># 找目录项, 其实就是对 find_file_dir_entry 的一个封装, 这里我只是为了方便而已</span><span class="token keyword">def</span> <span class="token function">find_sub_dir_clust_idx_list</span><span class="token punctuation">(</span>dir_name<span class="token punctuation">,</span> parent_clust_idx_list<span class="token punctuation">,</span> root_dir_entry_offset<span class="token punctuation">,</span> root_clust_idx<span class="token punctuation">,</span> sector_per_clust<span class="token punctuation">,</span> byte_per_sector<span class="token punctuation">,</span> disk<span class="token punctuation">,</span> suffix<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag<span class="token punctuation">,</span> dentry <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">""</span>    <span class="token keyword">for</span> clust_idx <span class="token keyword">in</span> parent_clust_idx_list<span class="token punctuation">:</span>        <span class="token keyword">if</span> flag<span class="token punctuation">:</span> <span class="token keyword">break</span>        <span class="token triple-quoted-string string">"""        file_clust_offset = root_dir_entry_offset + (clust_idx - root_clust_idx)*sector_per_clust*byte_per_sector#        print("file_clust_offset:", hex(file_clust_offset))        content = disk.read(file_clust_offset+sector_per_clust*byte_per_sector)[file_clust_offset:].decode(encoding='latin-1')        disk.seek(0)        for i in range(0, len(content), 0x20):            dentry = content[i:i+0x20]            if str(dentry[:len(dir_name)]) == str.upper(dir_name):                flag = True                break        """</span>        dir_offset <span class="token operator">=</span> root_dir_entry_offset <span class="token operator">+</span> <span class="token punctuation">(</span>clust_idx <span class="token operator">-</span> root_clust_idx<span class="token punctuation">)</span><span class="token operator">*</span>sector_per_clust<span class="token operator">*</span>byte_per_sector        max_len <span class="token operator">=</span> sector_per_clust<span class="token operator">*</span>byte_per_sector <span class="token operator">//</span> <span class="token number">0x20</span>        dentry<span class="token punctuation">,</span> flag <span class="token operator">=</span> find_file_dir_entry<span class="token punctuation">(</span>dir_name<span class="token punctuation">,</span> dir_offset<span class="token punctuation">,</span> disk<span class="token punctuation">,</span> suffix<span class="token punctuation">,</span> max_len<span class="token punctuation">)</span>    <span class="token keyword">return</span> dentry<span class="token comment"># 读取文件内容并写入新文件</span><span class="token keyword">def</span> <span class="token function">read_file_by_clust_list</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> suffix<span class="token punctuation">,</span> clust_idx_list<span class="token punctuation">,</span> file_size<span class="token punctuation">,</span> root_clust_idx<span class="token punctuation">,</span> root_dir_entry_offset<span class="token punctuation">,</span> sector_per_clust<span class="token punctuation">,</span> byte_per_sector<span class="token punctuation">,</span> disk<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token operator">+</span><span class="token string">"2."</span><span class="token operator">+</span>suffix<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>clust_idx_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            clust_idx <span class="token operator">=</span> clust_idx_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            file_clust_offset <span class="token operator">=</span> root_dir_entry_offset <span class="token operator">+</span> <span class="token punctuation">(</span>clust_idx <span class="token operator">-</span> root_clust_idx<span class="token punctuation">)</span><span class="token operator">*</span>sector_per_clust<span class="token operator">*</span>byte_per_sector            content <span class="token operator">=</span> disk<span class="token punctuation">.</span>read<span class="token punctuation">(</span>file_clust_offset<span class="token operator">+</span>sector_per_clust<span class="token operator">*</span>byte_per_sector<span class="token punctuation">)</span><span class="token punctuation">[</span>file_clust_offset<span class="token punctuation">:</span><span class="token punctuation">]</span>            disk<span class="token punctuation">.</span>seek<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>clust_idx_list<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>file_size <span class="token operator">%</span> <span class="token punctuation">(</span>sector_per_clust<span class="token operator">*</span>byte_per_sector<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                content <span class="token operator">=</span> content<span class="token punctuation">[</span><span class="token punctuation">:</span>file_size<span class="token operator">-</span>sector_per_clust<span class="token operator">*</span>byte_per_sector<span class="token operator">*</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>clust_idx_list<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n\"{0}\" 的文件内容已经存入 \"{1}\"\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token operator">+</span><span class="token string">"."</span><span class="token operator">+</span>suffix<span class="token punctuation">,</span> filename<span class="token operator">+</span><span class="token string">"2."</span><span class="token operator">+</span>suffix<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>    file_list_str <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>    file_list_str<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> suffix <span class="token operator">=</span> file_list_str<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> maxsplit<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> file_list_str<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> maxsplit<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token comment">#    print(file_list_str)</span><span class="token comment">#    print(suffix)</span>    disk <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'\\.\\'</span> <span class="token operator">+</span> file_list_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span>    byte_per_sector<span class="token punctuation">,</span> sector_per_clust<span class="token punctuation">,</span> saved_sector<span class="token punctuation">,</span> fat_nums<span class="token punctuation">,</span> sector_per_fat<span class="token punctuation">,</span> root_clust_idx <span class="token operator">=</span> read_BPB<span class="token punctuation">(</span>disk<span class="token punctuation">)</span>    root_dir_entry_offset <span class="token operator">=</span> <span class="token punctuation">(</span>saved_sector <span class="token operator">+</span> fat_nums<span class="token operator">*</span>sector_per_fat<span class="token punctuation">)</span> <span class="token operator">*</span> byte_per_sector<span class="token comment">#    print(file_list_str)</span><span class="token comment">#    print("root_dir_entry_offset: ", hex(root_dir_entry_offset))</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>file_list_str<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>        dentry<span class="token punctuation">,</span> _ <span class="token operator">=</span>  find_file_dir_entry<span class="token punctuation">(</span>file_list_str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> root_dir_entry_offset<span class="token punctuation">,</span> disk<span class="token punctuation">,</span> suffix<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        dentry<span class="token punctuation">,</span> _ <span class="token operator">=</span>  find_file_dir_entry<span class="token punctuation">(</span>file_list_str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> root_dir_entry_offset<span class="token punctuation">,</span> disk<span class="token punctuation">)</span><span class="token comment">#    binary_dump(dentry)</span>    clust_idx<span class="token punctuation">,</span> file_size <span class="token operator">=</span> get_clust_idx_and_file_size_by_dentry<span class="token punctuation">(</span>dentry<span class="token punctuation">)</span><span class="token comment">#    print("clust_idx: ", hex(clust_idx))</span><span class="token comment">#    print("file_size: ", hex(file_size))</span>    fat_offset <span class="token operator">=</span> saved_sector <span class="token operator">*</span> byte_per_sector    fat_size <span class="token operator">=</span> fat_nums <span class="token operator">*</span> sector_per_fat <span class="token operator">*</span> byte_per_sector<span class="token comment">#    print("fat_offset: ", hex(fat_offset))</span>    clust_idx_list <span class="token operator">=</span> get_clust_list_by_fat<span class="token punctuation">(</span>clust_idx<span class="token punctuation">,</span> fat_offset<span class="token punctuation">,</span> fat_size<span class="token punctuation">,</span> disk<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>file_list_str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>file_list_str<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            dentry <span class="token operator">=</span> find_sub_dir_clust_idx_list<span class="token punctuation">(</span>file_list_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> clust_idx_list<span class="token punctuation">,</span> root_dir_entry_offset<span class="token punctuation">,</span> root_clust_idx<span class="token punctuation">,</span> sector_per_clust<span class="token punctuation">,</span> byte_per_sector<span class="token punctuation">,</span> disk<span class="token punctuation">,</span> suffix<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            dentry <span class="token operator">=</span> find_sub_dir_clust_idx_list<span class="token punctuation">(</span>file_list_str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> clust_idx_list<span class="token punctuation">,</span> root_dir_entry_offset<span class="token punctuation">,</span> root_clust_idx<span class="token punctuation">,</span> sector_per_clust<span class="token punctuation">,</span> byte_per_sector<span class="token punctuation">,</span> disk<span class="token punctuation">)</span>        <span class="token comment">#binary_dump(dentry)</span>        clust_idx<span class="token punctuation">,</span> file_size <span class="token operator">=</span> get_clust_idx_and_file_size_by_dentry<span class="token punctuation">(</span>dentry<span class="token punctuation">)</span>        <span class="token comment">#print("{0} 2".format(hex(clust_idx)))</span>        clust_idx_list <span class="token operator">=</span> get_clust_list_by_fat<span class="token punctuation">(</span>clust_idx<span class="token punctuation">,</span> fat_offset<span class="token punctuation">,</span> fat_size<span class="token punctuation">,</span> disk<span class="token punctuation">)</span>        <span class="token comment">#print("{0} 3".format(i))</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\"{0}\" 的短文件名目录项为: \n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>    binary_dump<span class="token punctuation">(</span>dentry<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"     起始簇号为: "</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>clust_idx<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"     实际文件长度为: "</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>file_size<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># 输出文件簇链</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n\"{0}\" 的簇链为: \n     "</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> clust_idx_list<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">" ==&gt; "</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"0xfffffff(结束标志)"</span><span class="token punctuation">)</span>    read_file_by_clust_list<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> maxsplit<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> suffix<span class="token punctuation">,</span> clust_idx_list<span class="token punctuation">,</span> file_size<span class="token punctuation">,</span> root_clust_idx<span class="token punctuation">,</span> root_dir_entry_offset<span class="token punctuation">,</span> sector_per_clust<span class="token punctuation">,</span> byte_per_sector<span class="token punctuation">,</span> disk<span class="token punctuation">)</span>    <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment">#    filename = input("请输入正确格式的\033[31m绝对文件路径, 其中路径用 \"/\" 进行分割\033[0m, 如 \033[32m\"F:/lab/123/test.txt\"\033[0m : ")</span><span class="token comment">#    filename = "F:/321/123/456/789/zbp_c.txt"</span><span class="token comment">#    filename = "F:/123456789ABCDEFJLMOPQRESUVWXYZ.txt"</span><span class="token comment">#    filename = "F:/PPPP.docx"</span><span class="token comment">#    filename = "F:/GFEDCBA9876543210/132/ABCDEFHJHQDJHHJJHHHHHD/132dsa1d321s32a1dqw5/123456789ABCDEFJLMOPQRESUVWXYZ.txt"</span><span class="token comment">#    filename = "F:/GFEDCBA9876543210/132/xx.txt"    </span>        <span class="token comment"># 将 filename 替换成自己的文件即可</span>    <span class="token comment"># filename = "F:/GFEDCBA9876543210/132/ABCDEFHJHQDJHHJJHHHHHD/132dsa1d321s32a1dqw5/xxx/123456789ABCDEFJLMOPQRESUVWXYZ.docx"</span>    filename <span class="token operator">=</span> <span class="token string">"F:/zbp_c.txt"</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"请注意, \033[31m文件路径必须是绝对路径, 且用 \"/\" 进行分割\033[0m, 如 \033[32m\"F:/lab/123/test.txt\"\033[0m"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正在尝试解析该文件, 请耐心等待......"</span><span class="token punctuation">)</span>        run<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\"{0}\" 文件不存在"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><p>感谢组长大佬zqb的带领，没有他我肯定是不能独立完成实验全部内容。</p>]]></content>
      
      
      <categories>
          
          <category> 软件安全 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软件安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pyside6实践_1</title>
      <link href="/2023/10/19/pyside6-shi-jian-1/"/>
      <url>/2023/10/19/pyside6-shi-jian-1/</url>
      
        <content type="html"><![CDATA[<p>做实验的时候想拷贝电子参考书代码的时候发现代码都数字序号，手动删除太麻烦了，于是边想着写一个python脚本删除序号，然后不知道怎么突发奇想想试试Python GUI。</p><p>也是第一次接触，故记录一下。</p><h3 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token punctuation">,</span>re<span class="token keyword">from</span> PySide6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token punctuation">(</span>QLineEdit<span class="token punctuation">,</span> QPushButton<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>    QVBoxLayout<span class="token punctuation">,</span> QDialog<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QPlainTextEdit<span class="token punctuation">,</span>QMessageBox<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">)</span><span class="token keyword">from</span> PySide6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Qt<span class="token keyword">from</span> PySide6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QIcon<span class="token keyword">from</span> PySide6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QKeyEvent<span class="token punctuation">,</span>QTextCursor<span class="token punctuation">,</span>QGuiApplication<span class="token keyword">class</span> <span class="token class-name">CustomPlainTextEdit</span><span class="token punctuation">(</span>QPlainTextEdit<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">keyPressEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">:</span> QKeyEvent<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> event<span class="token punctuation">.</span>key<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">int</span><span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>Key_Return<span class="token punctuation">)</span> <span class="token keyword">or</span> event<span class="token punctuation">.</span>key<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">int</span><span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>Key_Enter<span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>moveCursor<span class="token punctuation">(</span>QTextCursor<span class="token punctuation">.</span>End<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>insertPlainText<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>            <span class="token keyword">return</span>        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>keyPressEvent<span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Form</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>Form<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token comment">#parent指定对话框的父窗口</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">"请输入文本，将帮您实现去除每行文本开头数字序号和空格："</span><span class="token punctuation">)</span>        <span class="token comment"># 创建组件</span>        self<span class="token punctuation">.</span>edit <span class="token operator">=</span> CustomPlainTextEdit<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>setFixedWidth<span class="token punctuation">(</span><span class="token number">450</span><span class="token punctuation">)</span>  <span class="token comment"># 设置宽度为200像素</span>        self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>setFixedHeight<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>  <span class="token comment"># 设置高度为30像素</span>        <span class="token comment">#self.edit.setAlignment(Qt.AlignTop)  # 将文本对齐方式设置为顶部对齐</span>        self<span class="token punctuation">.</span>lines <span class="token operator">=</span> <span class="token punctuation">[</span>_ <span class="token keyword">for</span> _ <span class="token keyword">in</span> self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>toPlainText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>button <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">"Run"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>button_copy <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">"一键复制结果"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>button_copy<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>copy_text<span class="token punctuation">)</span>        <span class="token comment"># 创建布局并添加组件</span>        layout <span class="token operator">=</span> QGridLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>        layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>label<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>        layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>button_copy<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>        layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>edit<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>        layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>button<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token comment"># 设置窗口图标</span>        icon <span class="token operator">=</span> QIcon<span class="token punctuation">(</span><span class="token string">"logo.ico"</span><span class="token punctuation">)</span>  <span class="token comment"># 替换为自己的图标路径</span>        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>icon<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">"Wq's tool"</span><span class="token punctuation">)</span>        <span class="token comment"># 应用布局</span>        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>layout<span class="token punctuation">)</span>        <span class="token comment"># 连接greetings槽和按钮单击信号</span>        self<span class="token punctuation">.</span>button<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>greetings<span class="token punctuation">)</span>    <span class="token comment"># 实现对输入文本的处理，由于是对话框的输出，保持原来的函数名字greetings()</span>    <span class="token keyword">def</span> <span class="token function">greetings</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment">#这里在给self.lines赋值是因为似乎之前定义之前没按钮没生效，之前定义应该赋空值，懒得改了，没什么错误那就保持原样吧。。。</span>        self<span class="token punctuation">.</span>lines <span class="token operator">=</span> <span class="token punctuation">[</span>_ <span class="token keyword">for</span> _ <span class="token keyword">in</span> self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>toPlainText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i<span class="token punctuation">,</span>line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lines<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment">#调用re.sub(正则表达式，替换后的字符，需要替换掉原味奶)</span>            self<span class="token punctuation">.</span>lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'^\d+\s*'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span>        <span class="token comment">#这里再开一个窗口</span>        message_box <span class="token operator">=</span> QMessageBox<span class="token punctuation">(</span><span class="token punctuation">)</span>        message_box<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">"出た！"</span><span class="token punctuation">)</span>        <span class="token comment"># 这里还有几个默认的参数没放出来</span>        <span class="token comment"># message_box.setIcon(QMessageBox.Information) 默认提示框图标为信息</span>        <span class="token comment"># message_box.addButton(QMessageBox.Ok) 默认有一个ok键</span>        output_text <span class="token operator">=</span> <span class="token string">""</span>  <span class="token comment"># 初始化空字符串</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> self<span class="token punctuation">.</span>lines<span class="token punctuation">:</span>            output_text <span class="token operator">+=</span> line            output_text <span class="token operator">+=</span> <span class="token string">"\n"</span>        message_box<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>output_text<span class="token punctuation">)</span>        message_box<span class="token punctuation">.</span>setFixedSize<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>        message_box<span class="token punctuation">.</span>setTextInteractionFlags<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>TextSelectableByMouse <span class="token operator">|</span> Qt<span class="token punctuation">.</span>TextSelectableByKeyboard<span class="token punctuation">)</span><span class="token comment"># 设置消息框的文本格式为可选择和可复制</span>        message_box<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">copy_text</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>lines <span class="token operator">=</span> <span class="token punctuation">[</span>_ <span class="token keyword">for</span> _ <span class="token keyword">in</span> self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>toPlainText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lines<span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'^\d+\s*'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span>        clipboard <span class="token operator">=</span> QGuiApplication<span class="token punctuation">.</span>clipboard<span class="token punctuation">(</span><span class="token punctuation">)</span>        output_text <span class="token operator">=</span> <span class="token string">""</span>  <span class="token comment"># 初始化空字符串</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> self<span class="token punctuation">.</span>lines<span class="token punctuation">:</span>            output_text <span class="token operator">+=</span> line            output_text <span class="token operator">+=</span> <span class="token string">"\n"</span>        clipboard<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>output_text<span class="token punctuation">)</span>  <span class="token comment"># 将输出文本设置到剪贴板</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment"># 创建Qt应用程序</span>    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>    <span class="token comment"># 创建并显示Form</span>    form <span class="token operator">=</span> Form<span class="token punctuation">(</span><span class="token punctuation">)</span>    form<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 运行Qt主循环</span>    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="效果截图"><a href="#效果截图" class="headerlink" title="效果截图"></a>效果截图</h3><p><img src="/2023/10/19/pyside6-shi-jian-1/image-20231019215938556.png" alt="image-20231019215938556"></p><p><img src="/2023/10/19/pyside6-shi-jian-1/image-20231019220033073.png" alt="image-20231019220033073"></p><p>一键复制功能就不展示了，按下按钮即可复制。</p><p>虽然对我来说很艰巨，但是放在github上面还是显得和大佬格格不入，自己记录一下就好了。</p><p>捋一下思路</p><p>先创建Qt应用程序</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>创建并显示Form(创建对话框窗口。QDialog)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">form <span class="token operator">=</span> Form<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Form</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#表示创建的是QDialog的子类</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>Form<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token comment">#parent指定对话框的父窗口,None即无父窗口</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">"请输入文本，将帮您实现去除每行文本开头数字序号和空格："</span><span class="token punctuation">)</span>        <span class="token comment"># 创建组件</span>        self<span class="token punctuation">.</span>edit <span class="token operator">=</span> CustomPlainTextEdit<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>setFixedWidth<span class="token punctuation">(</span><span class="token number">450</span><span class="token punctuation">)</span>  <span class="token comment"># 设置宽度为200像素</span>        self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>setFixedHeight<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>  <span class="token comment"># 设置高度为30像素</span>        <span class="token comment">#原本使用的是self.edit = QLineEdit(),故需要设置顶部对齐，但好像按enter不能换行</span>        <span class="token comment">#self.edit.setAlignment(Qt.AlignTop)  # 将文本对齐方式设置为顶部对齐</span>        <span class="token comment">#设置输入框里内容为self.line并且split("\n")</span>        self<span class="token punctuation">.</span>lines <span class="token operator">=</span> <span class="token punctuation">[</span>_ <span class="token keyword">for</span> _ <span class="token keyword">in</span> self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>toPlainText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token comment">#set functional button</span>        self<span class="token punctuation">.</span>button <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">"Run"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>button_copy <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">"一键复制结果"</span><span class="token punctuation">)</span>        <span class="token comment">#将复制键和self.copy_text函数关联起来</span>        self<span class="token punctuation">.</span>button_copy<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>copy_text<span class="token punctuation">)</span>        <span class="token comment"># 创建布局并添加组件</span>        <span class="token comment"># 这里我原本使用的是QVBoxlayout即垂直分布，另还有QHBoxlayout</span>        layout <span class="token operator">=</span> QGridLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>        layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>label<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>        layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>button_copy<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>        layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>edit<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>        layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>button<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token comment"># 设置窗口图标</span>        icon <span class="token operator">=</span> QIcon<span class="token punctuation">(</span><span class="token string">"logo.ico"</span><span class="token punctuation">)</span>  <span class="token comment"># 替换为自己的图标路径</span>        self<span class="token punctuation">.</span>setWindowIcon<span class="token punctuation">(</span>icon<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">"Wq's tool"</span><span class="token punctuation">)</span>        <span class="token comment"># 应用布局</span>        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>layout<span class="token punctuation">)</span>        <span class="token comment"># self.button连接greetings槽和按钮单击信号</span>        self<span class="token punctuation">.</span>button<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>greetings<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>class Form(QDialog): </p><ul><li><p>即<code>Form</code> 类继承自 <code>QDialog</code> 类，意味着 <code>Form</code> 类将继承 <code>QDialog</code> 类的属性和方法，并且可以在此基础上添加自己的特定行为和属性。</p></li><li><p><code>QDialog</code> 是Qt框架中提供的一个类，用于创建对话框窗口。对话框是一种常见的用户界面组件，用于与用户进行交互，接受输入或显示信息。</p></li><li><p>将 <code>Form</code> 类定义为 <code>QDialog</code> 的子类，你可以扩展 <code>QDialog</code> 类提供的功能，以满足特定的需求。可以添加自定义的布局、控件和逻辑，以及重写和扩展 <code>QDialog</code> 类中的方法来实现定制化的对话框窗口。</p></li></ul><p>补充：在Python中，<code>super()</code> 函数是用于调用父类（超类）的方法。它的作用是获取当前类的父类，并调用父类的方法。<code>super(Form, self).__init__(parent)</code> 的作用是调用 <code>Form</code> 类的父类 <code>QDialog</code> 的 <code>__init__</code> 方法，并传递 <code>parent</code> 参数给它。Python中，如果一个类继承自另一个类，那么在子类中重写父类的方法时，可以使用 <code>super()</code> 来调用父类的同名方法并扩展其功能。在Python 3及以上的版本中，可以使用简化的语法 <code>super().__init__(parent)</code> 来调用父类的方法，而不需要显式地指定类名和实例对象。但在旧版本的Python中，仍然需要使用 <code>super(Form, self).__init__(parent)</code> 的形式来调用父类的方法。</p><p><code>QGridLayout</code> 是一种布局管理器，用于将窗口或小部件按照网格的形式进行排列。</p><p>常用的布局管理器：</p><ol><li>QVBoxLayout：垂直布局管理器，将小部件垂直排列。</li><li>QHBoxLayout：水平布局管理器，将小部件水平排列。</li><li>QFormLayout：表单布局管理器，用于创建标签和输入字段的组合。</li><li>QStackedLayout：堆叠布局管理器，用于在同一区域显示多个小部件，但一次只显示一个小部件。</li><li>QBoxLayout：通用的盒式布局管理器，可以将小部件水平或垂直排列。</li><li>QGridLayout：网格布局管理器，以网格形式将小部件排列。</li><li>QSizePolicy：调整小部件大小策略的类，可与其他布局管理器一起使用。</li></ol><p>这些布局管理器可以根据您的需求进行嵌套和组合使用，以创建复杂的界面布局。您可以根据小部件的类型和排列需求选择适当的布局管理器来实现所需的布局效果。</p><p>然后实现与Run键相关联的函数/槽</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">greetings</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment">#这里在给self.lines赋值是因为似乎之前定义之前没按钮没生效，之前定义应该赋空值，懒得改了，没什么错误那就保持原样吧。。。</span>        self<span class="token punctuation">.</span>lines <span class="token operator">=</span> <span class="token punctuation">[</span>_ <span class="token keyword">for</span> _ <span class="token keyword">in</span> self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>toPlainText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i<span class="token punctuation">,</span>line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lines<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment">#调用re.sub(正则表达式，替换后的字符，需要替换掉原味奶)</span>            self<span class="token punctuation">.</span>lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'^\d+\s*'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span>        <span class="token comment">#这里再开一个窗口</span>        message_box <span class="token operator">=</span> QMessageBox<span class="token punctuation">(</span><span class="token punctuation">)</span>        message_box<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">"出た！"</span><span class="token punctuation">)</span>        <span class="token comment"># 这里还有几个默认的参数没放出来</span>        <span class="token comment"># message_box.setIcon(QMessageBox.Information) 默认提示框图标为信息</span>        <span class="token comment"># message_box.addButton(QMessageBox.Ok) 默认有一个ok键</span>        output_text <span class="token operator">=</span> <span class="token string">""</span>  <span class="token comment"># 初始化空字符串</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> self<span class="token punctuation">.</span>lines<span class="token punctuation">:</span> <span class="token comment">#将要输出的信息循环赋值给output_text</span>            output_text <span class="token operator">+=</span> line            output_text <span class="token operator">+=</span> <span class="token string">"\n"</span>        message_box<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>output_text<span class="token punctuation">)</span>        message_box<span class="token punctuation">.</span>setFixedSize<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>        message_box<span class="token punctuation">.</span>setTextInteractionFlags<span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>TextSelectableByMouse <span class="token operator">|</span> Qt<span class="token punctuation">.</span>TextSelectableByKeyboard<span class="token punctuation">)</span><span class="token comment"># 设置消息框的文本格式为可选择和可复制</span>        message_box<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>实现与“一键复制”关联的函数/槽</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">copy_text</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>lines <span class="token operator">=</span> <span class="token punctuation">[</span>_ <span class="token keyword">for</span> _ <span class="token keyword">in</span> self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>toPlainText<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lines<span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>lines<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r'^\d+\s*'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span>        clipboard <span class="token operator">=</span> QGuiApplication<span class="token punctuation">.</span>clipboard<span class="token punctuation">(</span><span class="token punctuation">)</span>        output_text <span class="token operator">=</span> <span class="token string">""</span>  <span class="token comment"># 初始化空字符串</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> self<span class="token punctuation">.</span>lines<span class="token punctuation">:</span>            output_text <span class="token operator">+=</span> line            output_text <span class="token operator">+=</span> <span class="token string">"\n"</span>        clipboard<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>output_text<span class="token punctuation">)</span>  <span class="token comment"># 将输出文本设置到剪贴板</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>clipboard = QGuiApplication.clipboard()</p><p>clipboard.setText(output_text)  # 将输出文本设置到剪贴板</p><p>这是实现将文本复制到clipboard的核心代码</p><p>下面这个是自定义的 <code>QPlainTextEdit</code> 类，重写了 <code>keyPressEvent()</code> 方法以处理按键事件。在这个自定义类中，当用户按下回车键（Enter 键或 Return 键）时，会将光标移动到文本的末尾，并在末尾插入一个换行符。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">CustomPlainTextEdit</span><span class="token punctuation">(</span>QPlainTextEdit<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">keyPressEvent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">:</span> QKeyEvent<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> event<span class="token punctuation">.</span>key<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">int</span><span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>Key_Return<span class="token punctuation">)</span> <span class="token keyword">or</span> event<span class="token punctuation">.</span>key<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">int</span><span class="token punctuation">(</span>Qt<span class="token punctuation">.</span>Key_Enter<span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>moveCursor<span class="token punctuation">(</span>QTextCursor<span class="token punctuation">.</span>End<span class="token punctuation">)</span><span class="token comment"># 将光标移动到文本末尾</span>            self<span class="token punctuation">.</span>insertPlainText<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>            <span class="token keyword">return</span><span class="token comment"># 如果按下的不是回车键，则调用父类的 keyPressEvent() 方法处理其他按键事件</span>        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>keyPressEvent<span class="token punctuation">(</span>event<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个自定义类中，我们重写了 <code>keyPressEvent()</code> 方法，并在方法体内对按键事件进行处理。如果按下的键是回车键（Enter 键或 Return 键），则会执行 <code>if</code> 语句块中的操作：将光标移动到文本的末尾，并在末尾插入一个换行符。然后，通过 <code>return</code> 语句提前结束方法的执行。</p><p>如果按下的键不是回车键，则会调用父类的 <code>keyPressEvent()</code> 方法，以便处理其他按键事件的默认行为。</p><h3 id="使用Nuitka"><a href="#使用Nuitka" class="headerlink" title="使用Nuitka"></a>使用Nuitka</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nuitka <span class="token parameter variable">--standalone</span> --show-memory --show-progress --windows-disable-console --nofollow-imports --plugin-enable<span class="token operator">=</span>pyside6 --follow-import-to<span class="token operator">=</span>utils,src --output-dir<span class="token operator">=</span>out --windows-icon-from-ico<span class="token operator">=</span>./logo.ico demo.py  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p><code>--standalone</code>：方便移植到其他机器，不用再安装python</p></li><li><p><code>--show-memory --show-progress</code>：展示整个安装的进度过程</p></li><li><p><code>--windows-disable-console</code>：运行exe取消弹框。如果我们还需要调试，可能哪里还有问题之类的，就不用放上去了，但一般问题都在Pycharm解决了，就加上去</p></li><li><p><code>--nofollow-imports</code>：不编译代码中所有的import，比如keras，numpy之类的。</p></li><li><p><code>--plugin-enable=qt-plugins</code>：我这里用到pyside6来做界面的，这里nuitka有其对应的插件。还有pyqt之类的</p></li><li><p><code>--follow-import-to=utils,src</code>：需要编译成C++代码的指定的2个包含源码的文件夹，这里用<code>,</code>来进行分隔。</p></li><li><p><code>--output-dir=out</code>：指定输出的结果路径或者说输出文件夹名为out。</p></li><li><p><code>--windows-icon-from-ico=./logo.ico</code>：指定生成的exe的图标为logo.ico这个图标，这里使用的将图片转成ico格式文件的网站（<a href="https://www.bitbug.net/">比特虫</a>）。</p></li></ul><p>如果发现真正运行exe的时候，会报错：<code>no module named torch,cv2,tensorflow</code>等等这些没有转成C++的第三方包。</p><p>这里需要找到这些包复制（比如numpy,cv2这个文件夹）到<code>demo.dist</code>路径下。</p><p>至此，exe能完美运行啦！</p><p><a href="https://www.lixiaofei2yy.website/python%E7%9A%84%E6%89%93%E5%8C%85%E7%A5%9E%E5%99%A8nuitka">参考网站</a></p><p><a href="https://zhuanlan.zhihu.com/p/133303836">其它可参考网站</a></p><p>最后感谢免费的innosetup生成安装包 <a href="https://jrsoftware.org/isinfo.php">innosetup</a></p><h3 id="其它资源"><a href="#其它资源" class="headerlink" title="其它资源"></a>其它资源</h3><p><a href="https://www.pythonguis.com/">pyside6  pythonguis</a></p><p><a href="https://www.bilibili.com/video/BV1cJ411R7bP?p=1&amp;vd_source=6fb2d8618426a162edd6fcdb1c92b705">Designer写GUI</a></p>]]></content>
      
      
      <categories>
          
          <category> PySide6 </category>
          
          <category> Windows应用开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PySide6 </tag>
            
            <tag> Windows应用开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PySide6上手</title>
      <link href="/2023/10/19/pyside6-shang-shou/"/>
      <url>/2023/10/19/pyside6-shang-shou/</url>
      
        <content type="html"><![CDATA[<h1 id="创建第一个QtWidgets程序"><a href="#创建第一个QtWidgets程序" class="headerlink" title="创建第一个QtWidgets程序"></a>创建第一个QtWidgets程序</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">from</span> PySide6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QLabelapp <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>  <span class="token comment">#创建一个 QApplication 实例</span>label <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">"Hello World!"</span><span class="token punctuation">)</span>label<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>要用 PySide6 创建一个窗口程序，你必须先从 <em>PySide6.QtWidgets</em> 模块中引用需要使用的类。  </p><p>引用后，创建一个 <em>QApplication</em> 实例。</p><p>因为 Qt 可以从命令行接收参数，你可以向 <em>QApplication</em> 对象传递任意参数。一般情况下我们不需要传递参数，或者也可以像下面这样写：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>创建完 <em>QApplication</em> 对象后，我们还创建了 <em>QLabel</em> 对象。<em>QLabel</em> 是一个可以显示文本和图像的容器。文本可以是简单文本，也可以是富文本，像HTML一样。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># This HTML approach will be valid too!</span>label <span class="token operator">=</span> QLabel<span class="token punctuation">(</span><span class="token string">"&lt;font color=red size=40&gt;Hello World!&lt;/font&gt;"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>注意</strong><br>在创建完一个标签后，我们要对它调用 <code>show()</code> 函数。</p><p>最后，我们调用 <code>app.exec_()</code> 进入主循环，开始执行代码。事实上，只有执行到了这，标签才被显示，但是现在我们可以先忽略这点。</p><h1 id="创建一个简单按钮"><a href="#创建一个简单按钮" class="headerlink" title="创建一个简单按钮"></a>创建一个简单按钮</h1><p>如何用 Qt for Python 处理信号和槽。<strong>信号和槽</strong>是Qt的一个特色，用来让你的图形组件与其他图形组件或 Python 代码交流。</p><p>首先，引用所需的 <em>PySide6</em> 类和 <em>sys</em> 模块：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">from</span> PySide6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QPushButton<span class="token keyword">from</span> PySide6<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> Slot<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>然后创建一个函数，用来输出信息到控制台：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Greetings</span><span class="token decorator annotation punctuation">@Slot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">say_hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Button clicked, Hello!"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>注意</strong><br>@Slot() 是一个装饰器，用来将一个函数定义为槽函数。现在可以先不理解它，但是还是需要这么写来防止意外错误。</p><p>需要创建 <em>QApplication</em> 来运行你的代码，创建一个 <em>QPushButton</em> 实例，它是一个可点击的按钮。在创建时传入的字符串会显示在按钮上：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Create the Qt Application</span>app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token comment"># Create a button</span>button <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">"Click me"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>在显示按钮之前，我们需要将按钮与之前定义的 <code>say_hello()</code> 函数连接。有新老两种方法来建立连接，我们这里就演示新的方法。<em>QPushButton</em> 预定义了一个叫 <code>clicked</code> 的信号，每当按钮被按下就会触发该信号。我们要把这个信号和 <code>say_hello()</code> 函数连接：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Connect the button to the function</span>button<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>say_hello<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>最后，我们显示这个按钮，并进入主循环：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Show the button</span>button<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># Run the main Qt loop</span>app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>完整代码：</p><pre class="line-numbers language-\" data-language="\"><code class="language-\">#!/usr/bin/pythonimport sysfrom PySide6.QtWidgets import QApplication, QPushButtonfrom PySide6.QtCore import Slot@Slot()def say_hello(): print("Button clicked, Hello!")# Create the Qt Applicationapp = QApplication(sys.argv)# Create a button, connect it and show itbutton = QPushButton("Click me")button.clicked.connect(say_hello)button.show()# Run the main Qt loopapp.exec_()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="创建带输入框和按钮的对话框程序"><a href="#创建带输入框和按钮的对话框程序" class="headerlink" title="创建带输入框和按钮的对话框程序"></a>创建带输入框和按钮的对话框程序</h1><p>如何用 <em>QDialog</em> 创建一个简单的对话框程序。这个程序可以让用户在 <em>QLineEdit</em> 组件中填入自己的名字，然后当点击 <em>QPushButton</em> 组件时程序会跟你打招呼</p><p>从创建一个对话框窗口的代码开始</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">from</span> PySide6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QApplication<span class="token punctuation">,</span> QDialog<span class="token punctuation">,</span> QLineEdit<span class="token punctuation">,</span> QPushButton<span class="token keyword">class</span> <span class="token class-name">Form</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>Form<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>parent<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span><span class="token string">"My Form"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment"># 创建Qt应用程序</span>    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>    <span class="token comment"># 创建并显示Form</span>    form <span class="token operator">=</span> Form<span class="token punctuation">(</span><span class="token punctuation">)</span>    form<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 运行Qt主循环</span>    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>我们对引用模块、创建 <em>QApplication</em> 和执行 Qt 主循环都不陌生。这里唯一要新学的是<strong>类的定义</strong>。</p><ul><li><code>super(Form, self).__init__(parent)</code> 表示调用父类 QDialog 的构造函数来初始化对话框。<code>super()</code> 函数用于调用父类的方法，这里通过 <code>super(Form, self)</code> 来调用 QDialog 类的构造函数。<code>parent</code> 参数表示对话框的父级窗口，如果没有指定，默认为 None。</li><li><code>self.setWindowTitle("My Form")</code> 设置对话框的标题为 “My Form”，即对话框的窗口标题栏上显示的文字。</li></ul><p>可以在此基础上继续添加其他界面元素和逻辑，以构建出符合你需求的对话框。</p><p>我们可以任意创建 PySide6 中组件的子类。在上面的程序中，我们定义了一个 <em>QDialog</em> 的子类，并将它命名为 <em>Form</em>。我们还执行了 init() 方法，它可以调用父组件 QDialog 的初始化方法。另外，<em>setWindowTitle()</em> 方法可以设置对话窗口的标题。在 <em>main()</em> 函数里，我们创建了一个 <em>Form</em> 对象并让它显示出来</p><h2 id="创建组件"><a href="#创建组件" class="headerlink" title="创建组件"></a>创建组件</h2><p>接下来，我们需要创建两个组件：一个 <em>QLineEdit</em>，用来让用户填写他的名字；一个 <em>QPushButton</em>，用来输出 <em>QLineEdit</em> 中的内容。所以，在 Form 的 <em>init()</em> 方法中加入下面两行代码：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 创建组件</span>self<span class="token punctuation">.</span>edit <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span><span class="token string">"Write my name here.."</span><span class="token punctuation">)</span>self<span class="token punctuation">.</span>button <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">"Show Greetings"</span><span class="token punctuation">)</span><span class="token comment">#显而易见，这两个组件会显示对应的文字。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="创建布局以排列组件"><a href="#创建布局以排列组件" class="headerlink" title="创建布局以排列组件"></a>创建布局以排列组件</h2><p>Qt 中的布局支持可以帮助你排列程序中的组件。在这个例程中，我们用 <em>QVBoxLayout</em> 来对这两个组件进行<strong>垂直布局</strong>。在 <em>init()</em> 方法中创建组件的代码后加入下面的代码：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 创建布局并添加组件</span>layout <span class="token operator">=</span> QVBoxLayout<span class="token punctuation">(</span>self<span class="token punctuation">)</span>layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>edit<span class="token punctuation">)</span>layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>button<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>我们创建了布局，并使用 <em>addWidget()</em> 方法在布局里添加了组件。</p><h2 id="创建函数并连接按钮"><a href="#创建函数并连接按钮" class="headerlink" title="创建函数并连接按钮"></a>创建函数并连接按钮</h2><p>最后一步，在 Form 类中创建一个函数，并且将它和按钮连接。我们想要我们的函数成为 Form 类的一部分，所以把它加在 <em>init()</em> 函数之后：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 向用户打招呼</span><span class="token keyword">def</span> <span class="token function">greetings</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Hello </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>这个函数用来在控制台中输出 <em>QLineEdit</em> 中填入的内容。我们使用 <em>QLineEdit.text()</em> 方法获取文本。</p><p>然后只需要将 <em>QPushButton</em> 和 <em>Form.greetings()</em> 方法 <em>连接</em> 即可。在 <em>init()</em> 方法中加入下面这行代码：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 连接greetings槽和按钮单击信号</span>self<span class="token punctuation">.</span>button<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>greetings<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>尝试运行，你可以在 <em>QLineEdit</em> 中输入你的名字，然后看命令行向你打招呼。</p><h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">from</span> PySide6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token punctuation">(</span>QLineEdit<span class="token punctuation">,</span> QPushButton<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>    QVBoxLayout<span class="token punctuation">,</span> QDialog<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Form</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>         <span class="token builtin">super</span><span class="token punctuation">(</span>Form<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token comment">#parent指定对话框的父窗口</span>        <span class="token comment"># 创建组件</span>        self<span class="token punctuation">.</span>edit <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span><span class="token string">"Write my name here"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>button <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span><span class="token string">"Show Greetings"</span><span class="token punctuation">)</span>        <span class="token comment"># 创建布局并添加组件</span>        layout <span class="token operator">=</span> QVBoxLayout<span class="token punctuation">(</span><span class="token punctuation">)</span>        layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>edit<span class="token punctuation">)</span>        layout<span class="token punctuation">.</span>addWidget<span class="token punctuation">(</span>self<span class="token punctuation">.</span>button<span class="token punctuation">)</span>        <span class="token comment"># 应用布局</span>        self<span class="token punctuation">.</span>setLayout<span class="token punctuation">(</span>layout<span class="token punctuation">)</span>        <span class="token comment"># 连接greetings槽和按钮单击信号</span>        self<span class="token punctuation">.</span>button<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>greetings<span class="token punctuation">)</span>    <span class="token comment"># 向用户打招呼</span>    <span class="token keyword">def</span> <span class="token function">greetings</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Hello </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>edit<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment"># 创建Qt应用程序</span>    app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>    <span class="token comment"># 创建并显示Form</span>    form <span class="token operator">=</span> Form<span class="token punctuation">(</span><span class="token punctuation">)</span>    form<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 运行Qt主循环</span>    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="使用QTableWidget组件显示数据"><a href="#使用QTableWidget组件显示数据" class="headerlink" title="使用QTableWidget组件显示数据"></a>使用QTableWidget组件显示数据</h1><p>想要在表格里显示数据，可以直接使用 <em><strong>QTableWidget</strong></em> 组件来完成。本节教程将完成一个显示颜色列表的程序。</p><p>注意，使用 <em>QTableWidget</em> 不是在表格中显示信息的唯一方法。你也可以创建数据列表并用 <em>QTableView</em> 将其显示出来。</p><h2 id="引用-QTableWidget，QTableWidgetItem-和-QColor-来显示背景颜色"><a href="#引用-QTableWidget，QTableWidgetItem-和-QColor-来显示背景颜色" class="headerlink" title="引用 QTableWidget，QTableWidgetItem 和 QColor 来显示背景颜色"></a>引用 <em>QTableWidget</em>，<em>QTableWidgetItem</em> 和 <em>QColor</em> 来显示背景颜色</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">from</span> PySide6<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> QColor<span class="token keyword">from</span> PySide6<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token punctuation">(</span>QApplication<span class="token punctuation">,</span> QTableWidget<span class="token punctuation">,</span>                               QTableWidgetItem<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="创建列表来存储各种颜色对应的十六进制码"><a href="#创建列表来存储各种颜色对应的十六进制码" class="headerlink" title="创建列表来存储各种颜色对应的十六进制码"></a>创建列表来存储各种颜色对应的十六进制码</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"Red"</span><span class="token punctuation">,</span> <span class="token string">"#FF0000"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token punctuation">(</span><span class="token string">"Green"</span><span class="token punctuation">,</span> <span class="token string">"#00FF00"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token punctuation">(</span><span class="token string">"Blue"</span><span class="token punctuation">,</span> <span class="token string">"#0000FF"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token punctuation">(</span><span class="token string">"Black"</span><span class="token punctuation">,</span> <span class="token string">"#000000"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token punctuation">(</span><span class="token string">"White"</span><span class="token punctuation">,</span> <span class="token string">"#FFFFFF"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token punctuation">(</span><span class="token string">"Electric Green"</span><span class="token punctuation">,</span> <span class="token string">"#41CD52"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token punctuation">(</span><span class="token string">"Dark Blue"</span><span class="token punctuation">,</span> <span class="token string">"#222840"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token punctuation">(</span><span class="token string">"Yellow"</span><span class="token punctuation">,</span> <span class="token string">"#F9E56d"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="定义用来将十六进制码转换为RGB值的函数"><a href="#定义用来将十六进制码转换为RGB值的函数" class="headerlink" title="定义用来将十六进制码转换为RGB值的函数"></a>定义用来将十六进制码转换为RGB值的函数</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_rgb_from_hex</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">:</span>    code_hex <span class="token operator">=</span> code<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"#"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>    rgb <span class="token operator">=</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>code_hex<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> QColor<span class="token punctuation">.</span>fromRgb<span class="token punctuation">(</span>rgb<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rgb<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rgb<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="初始化-QApplication-对象"><a href="#初始化-QApplication-对象" class="headerlink" title="初始化 QApplication 对象"></a>初始化 <em>QApplication</em> 对象</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="循环列表，创建-QTableWidgetItems-对象，并按照-x-y-坐标将其加入表格"><a href="#循环列表，创建-QTableWidgetItems-对象，并按照-x-y-坐标将其加入表格" class="headerlink" title="循环列表，创建 QTableWidgetItems 对象，并按照 x, y 坐标将其加入表格"></a>循环列表，创建 <em>QTableWidgetItems</em> 对象，并按照 x, y 坐标将其加入表格</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> code<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>colors<span class="token punctuation">)</span><span class="token punctuation">:</span>    item_name <span class="token operator">=</span> QTableWidgetItem<span class="token punctuation">(</span>name<span class="token punctuation">)</span>    item_code <span class="token operator">=</span> QTableWidgetItem<span class="token punctuation">(</span>code<span class="token punctuation">)</span>    item_color <span class="token operator">=</span> QTableWidgetItem<span class="token punctuation">(</span><span class="token punctuation">)</span>    item_color<span class="token punctuation">.</span>setBackground<span class="token punctuation">(</span>get_rgb_from_hex<span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span>    table<span class="token punctuation">.</span>setItem<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> item_name<span class="token punctuation">)</span>    table<span class="token punctuation">.</span>setItem<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> item_code<span class="token punctuation">)</span>    table<span class="token punctuation">.</span>setItem<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> item_color<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="显示表格并运行-QApplication-循环"><a href="#显示表格并运行-QApplication-循环" class="headerlink" title="显示表格并运行 QApplication 循环"></a>显示表格并运行 <em>QApplication</em> 循环</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">table<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span>app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="最终运行效果"><a href="#最终运行效果" class="headerlink" title="最终运行效果"></a>最终运行效果</h2><p><img src="/2023/10/19/pyside6-shang-shou/image-20231019115252231.png" alt="image-20231019115252231"></p><p><a href="https://blog.csdn.net/baidu_36499789/article/details/113835688">参考链接</a></p>]]></content>
      
      
      <categories>
          
          <category> PySide6 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PySide6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ruby入门学习(1)</title>
      <link href="/2023/10/17/ruby-ru-men-xue-xi-1/"/>
      <url>/2023/10/17/ruby-ru-men-xue-xi-1/</url>
      
        <content type="html"><![CDATA[<h1 id="块"><a href="#块" class="headerlink" title="块"></a>块</h1><h3 id="yield用法"><a href="#yield用法" class="headerlink" title="yield用法"></a>yield用法</h3><p>其他编程语言中被称为闭包。 它由一组代码组成，它们始终用大括号括起来，或者在do..end之间书写。 大括号语法总是具有比do..end语法更高的优先级。也就是说大括号优先级高，do..end优先级低</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment">#!/usr/bin/ruby</span><span class="token comment"># -*- coding: UTF-8 -*-</span> <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">test</span></span>   puts <span class="token string-literal"><span class="token string">"在 test 方法内"</span></span>   <span class="token keyword">yield</span>   puts <span class="token string-literal"><span class="token string">"你又回到了 test 方法内"</span></span>   <span class="token keyword">yield</span><span class="token keyword">end</span>test <span class="token punctuation">{</span>puts <span class="token string-literal"><span class="token string">"你在块内"</span></span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里的块得放在函数后面，然名变量名字必须一样</p><p>还可以传递带有参数的 yield 语句</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment">#!/usr/bin/ruby</span><span class="token comment"># -*- coding: UTF-8 -*-</span> <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">test</span></span>   <span class="token keyword">yield</span> <span class="token number">5</span>   puts <span class="token string-literal"><span class="token string">"在 test 方法内"</span></span>   <span class="token keyword">yield</span> <span class="token number">100</span><span class="token keyword">end</span>test <span class="token punctuation">{</span><span class="token operator">|</span>i<span class="token operator">|</span> puts <span class="token string-literal"><span class="token string">"你在块 </span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">i</span><span class="token delimiter punctuation">}</span></span><span class="token string"> 内"</span></span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>想要传递多个参数，那么 <em>yield</em> 语句如下所示：</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token keyword">yield</span> a<span class="token punctuation">,</span> b<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>此时，块如下所示：</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby">test <span class="token punctuation">{</span><span class="token operator">|</span>a<span class="token punctuation">,</span> b<span class="token operator">|</span> statement<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="BEGIN-和-END-块"><a href="#BEGIN-和-END-块" class="headerlink" title="BEGIN 和 END 块"></a>BEGIN 和 END 块</h3><p>每个 Ruby 源文件可以声明当文件被加载时要运行的代码块（BEGIN 块），以及程序完成执行后要运行的代码块（END 块）</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment">#!/usr/bin/ruby</span> <span class="token keyword">BEGIN</span> <span class="token punctuation">{</span>   <span class="token comment"># BEGIN 代码块</span>  puts <span class="token string-literal"><span class="token string">"BEGIN 代码块"</span></span><span class="token punctuation">}</span>  <span class="token keyword">END</span> <span class="token punctuation">{</span>   <span class="token comment"># END 代码块</span>  puts <span class="token string-literal"><span class="token string">"END 代码块"</span></span><span class="token punctuation">}</span>  <span class="token comment"># MAIN 代码块</span>puts <span class="token string-literal"><span class="token string">"MAIN 代码块"</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出结果</p><pre class="line-numbers language-none"><code class="language-none">BEGIN 代码块MAIN 代码块END 代码块<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="块变量"><a href="#块变量" class="headerlink" title="块变量"></a>块变量</h3><p>可以在块参数外部和内部使用相同的变量，看看下面的例子。</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment">#!/usr/bin/ruby   </span>x <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"Outer variable"</span></span>    <span class="token number">3.</span>times <span class="token keyword">do</span> <span class="token operator">|</span>x<span class="token operator">|</span>    puts <span class="token string-literal"><span class="token string">"Inside the block: </span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">x</span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span>    <span class="token keyword">end</span>    puts <span class="token string-literal"><span class="token string">"Outside the block: </span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">x</span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span><span class="token comment">#输出结果</span><span class="token comment">=beginInside the block: 0Inside the block: 1Inside the block: 2Outside the block: Outer variable=end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="符号参数-amp-块"><a href="#符号参数-amp-块" class="headerlink" title="符号参数(&amp;块)"></a>符号参数(&amp;块)</h3><p><code>&amp;</code>块是一种将参考(而不是局部变量)传递给块的方法。这里，块之后的<code>&amp;</code>只是一个引用的名字，任何其他的名字都可以用它来代替。</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment">#!/usr/bin/ruby   </span><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">met</span></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>block<span class="token punctuation">)</span>     puts <span class="token string-literal"><span class="token string">"This is method"</span></span>     block<span class="token punctuation">.</span>call   <span class="token keyword">end</span>   met <span class="token punctuation">{</span> puts <span class="token string-literal"><span class="token string">"This is &amp;block example"</span></span> <span class="token punctuation">}</span><span class="token comment">=beginThis is methodThis is &amp;block example=end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里，<code>met</code>方法中的块变量是对块的引用，它使用<code>call</code>来执行。 调用方法与<code>yield</code>方法相同</p><h3 id="使用默认值初始化对象"><a href="#使用默认值初始化对象" class="headerlink" title="使用默认值初始化对象"></a>使用默认值初始化对象</h3><p>Ruby有一个初始化器，称为<code>yield(self)</code>。 在这里，<code>self</code>是被初始化的对象。yield(self)是类的初始化器（构造函数）中使用的一种常见技术。</p><p>当你在一个类的初始化器中调用<code>yield(self)</code>时，它会执行与当前对象相关联的块代码。这允许你在对象实例化的过程中执行一些自定义的逻辑或初始化操作，同时让块代码能够访问当前对象的实例变量和方法。</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token keyword">class</span> <span class="token class-name">Person</span>  attr_accessor <span class="token symbol">:name</span><span class="token punctuation">,</span> <span class="token symbol">:age</span>    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">initialize</span></span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>    <span class="token variable">@name</span> <span class="token operator">=</span> name    <span class="token variable">@age</span> <span class="token operator">=</span> age    <span class="token keyword">yield</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token keyword">if</span> block_given<span class="token operator">?</span>  <span class="token comment"># 调用块代码，并传递当前对象</span>  <span class="token keyword">end</span><span class="token keyword">end</span>person <span class="token operator">=</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"John"</span></span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>p<span class="token operator">|</span>  puts <span class="token string-literal"><span class="token string">"Custom initialization for </span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">p<span class="token punctuation">.</span>name</span><span class="token delimiter punctuation">}</span></span><span class="token string">"</span></span>  <span class="token comment"># 执行额外的自定义逻辑或初始化操作</span><span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>Person</code>类具有<code>name</code>和<code>age</code>实例变量，并定义了一个初始化器。当创建一个<code>Person</code>对象时，可以传递一个块代码给初始化器，并使用<code>yield(self)</code>调用该块代码。块代码可以访问传递给它的<code>Person</code>对象，以便执行自定义的初始化操作。</p><p>通过使用<code>yield(self)</code>，你可以在对象实例化的过程中以一种灵活的方式执行额外的代码，并与当前对象进行交互。这对于执行一些初始化逻辑、设置默认值或注册回调等操作非常有用。</p><p>注意：<code>attr_accessor :name, :age</code>是Ruby中的一个简便方法，用于定义对象的属性（属性访问器）。</p><p><code>attr_accessor</code>是一个Ruby的关键字，它接受一个或多个属性名作为参数，并为每个属性生成对应的读取器（getter）和写入器（setter）方法。</p><p>在这个特定的例子中，<code>attr_accessor :name, :age</code>会为类或模块中的实例变量<code>@name</code>和<code>@age</code>生成以下方法：</p><ol><li>读取器方法（getter）：生成一个方法来获取属性的值。对于属性<code>:name</code>，生成的方法名为<code>name</code>，通过调用<code>object.name</code>来获取<code>@name</code>的值。对于属性<code>:age</code>，生成的方法名为<code>age</code>，通过调用<code>object.age</code>来获取<code>@age</code>的值。</li><li>写入器方法（setter）：生成一个方法来设置属性的值。对于属性<code>:name</code>，生成的方法名为<code>name=</code>，通过调用<code>object.name = new_value</code>来设置<code>@name</code>的值为<code>new_value</code>。对于属性<code>:age</code>，生成的方法名为<code>age=</code>，通过调用<code>object.age = new_value</code>来设置<code>@age</code>的值为<code>new_value</code>。</li></ol><h3 id="参考说明"><a href="#参考说明" class="headerlink" title="参考说明"></a>参考说明</h3><p><a href="https://www.yiibai.com/ruby/blocks.html">易百教程</a></p><p><a href="https://www.runoob.com/ruby/ruby-block.html">菜鸟教程</a></p>]]></content>
      
      
      <categories>
          
          <category> Ruby </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ruby </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>图像分类(VGG)(1)</title>
      <link href="/2023/10/14/tu-xiang-fen-lei-vgg-1/"/>
      <url>/2023/10/14/tu-xiang-fen-lei-vgg-1/</url>
      
        <content type="html"><![CDATA[<h1 id="已完成训练的VGG模型的使用方法"><a href="#已完成训练的VGG模型的使用方法" class="headerlink" title="已完成训练的VGG模型的使用方法"></a>已完成训练的VGG模型的使用方法</h1><p>使用ImageNet数据集中已经提前训练好网络参数的VGG-16模型来实现对未知图片进行自动分类处理的程序。<br>ImageNet是斯坦福大学从互联网上收集的已分类的图像数据集，ILSVRC竞赛常用（ImageNet Large Scale Visual Recognition Challenge）<br>Torch中可以轻松使用ImageNet数据集中的ILSVRC2012数据集（分类数：1000种；训练用数据：120万张；验证用数据：5万张；测试用数据：10万张）</p><h2 id="文件夹准备"><a href="#文件夹准备" class="headerlink" title="文件夹准备"></a>文件夹准备</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request<span class="token keyword">import</span> zipfile<span class="token comment">#·文件夹“data”不存在时制作</span>data_dir <span class="token operator">=</span> <span class="token string">"./data/"</span><span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>    os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span><span class="token comment">#下载ImageNet的class_index</span><span class="token comment">#是在Keras准备的。</span><span class="token comment"># https://github.com/fchollet/deep-learning-models/blob/master/imagenet_utils.py</span>url <span class="token operator">=</span> <span class="token string">"https://s3.amazonaws.com/deep-learning-models/image-models/imagenet_class_index.json"</span>save_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> <span class="token string">"imagenet_class_index.json"</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>save_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlretrieve<span class="token punctuation">(</span>url<span class="token punctuation">,</span> save_path<span class="token punctuation">)</span><span class="token comment">#1.3下载并解压缩你要用到的蚂蚁和蜜蜂的图像数据</span><span class="token comment"># 是在PyTorch指南课程中准备的。</span><span class="token comment"># https://pytorch.org/tutorials/beginner/transfer_learning_tutorial.html</span>url <span class="token operator">=</span> <span class="token string">"https://download.pytorch.org/tutorial/hymenoptera_data.zip"</span>save_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>data_dir<span class="token punctuation">,</span> <span class="token string">"hymenoptera_data.zip"</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>save_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlretrieve<span class="token punctuation">(</span>url<span class="token punctuation">,</span> save_path<span class="token punctuation">)</span>    <span class="token comment"># 读取ZIP文件</span>    <span class="token builtin">zip</span> <span class="token operator">=</span> zipfile<span class="token punctuation">.</span>ZipFile<span class="token punctuation">(</span>save_path<span class="token punctuation">)</span>    <span class="token builtin">zip</span><span class="token punctuation">.</span>extractall<span class="token punctuation">(</span>data_dir<span class="token punctuation">)</span>  <span class="token comment"># 解压缩ZIP</span>    <span class="token builtin">zip</span><span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 盗取ZIP文件</span>    <span class="token comment">#删除ZIP文件</span>    os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>save_path<span class="token punctuation">)</span>【※（实施完）】手动下载金毛寻回犬的图像https<span class="token punctuation">:</span><span class="token operator">//</span>pixabay<span class="token punctuation">.</span>com<span class="token operator">/</span>ja<span class="token operator">/</span>photos<span class="token operator">/</span>goldenretriever<span class="token operator">-</span><span class="token operator">%</span>E7<span class="token operator">%</span>8A<span class="token operator">%</span>AC<span class="token operator">-</span><span class="token number">3724972</span><span class="token operator">/</span>640x426尺寸的图像（图片版权信息<span class="token punctuation">:</span>CCO Creative Commons，免费商业使用，无需标注归属）将其直接放在文件夹“data”的下方。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>导入软件包</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 导入软件包</span><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> json<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token operator">%</span>matplotlib inline<span class="token keyword">import</span> torch<span class="token keyword">import</span> torchvision<span class="token keyword">from</span> torchvision <span class="token keyword">import</span> models<span class="token punctuation">,</span> transforms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>VGG-16已完成训练模型的载入</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#VGG-16已完成训练模型的载入</span><span class="token comment"># 第一次执行时，由于需要从网络下载学习好的参数数据，因此执行时间会稍微长一些</span><span class="token comment">#生成VGG-16模型的实例</span>use_pretrained <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># 使用已经训练好的参数</span>net <span class="token operator">=</span> models<span class="token punctuation">.</span>vgg16<span class="token punctuation">(</span>pretrained<span class="token operator">=</span>use_pretrained<span class="token punctuation">)</span>net<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 设置为推测模式</span><span class="token comment">#  输出模型的网络结构</span><span class="token keyword">print</span><span class="token punctuation">(</span>net<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>实现一个对输入图片进行预处理的类BaseTransform()<br>注意：这里的__call__()作用是，如果不指定函数名而直接调用实例的变量名，<strong>call</strong>()函数内的代码直接会被执行。这里等于说就是直接返回一个被预处理过后的一个图片。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 对输入图片进行预处理的类</span><span class="token keyword">class</span> <span class="token class-name">BaseTransform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    调整图片的尺寸，并对颜色进行规范化。    Attributes    ----------    resize : int       指定调整尺寸后图片的大小    mean : (R, G, B)       各个颜色通道的平均值    std : (R, G, B)       各个颜色通道的标准偏差    """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> resize<span class="token punctuation">,</span> mean<span class="token punctuation">,</span> std<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>base_transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>            transforms<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span>resize<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#将较短边的长度作为resize的大小</span>            transforms<span class="token punctuation">.</span>CenterCrop<span class="token punctuation">(</span>resize<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#从图片中央截取resize × resize大小的区域</span>            transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">#转换为Torch张量</span>            transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span>mean<span class="token punctuation">,</span> std<span class="token punctuation">)</span>  <span class="token comment">#颜色信息的正规化</span>        <span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> img<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>base_transform<span class="token punctuation">(</span>img<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>plt.show()一下预处理的效果，可省略.</p><p>注意：由于tentor即张量为( 颜色、高度、宽度 )，转换成np后需要转换为 ( 高度、宽度、颜色 )img_transformed = img_transformed.numpy().transpose((1, 2, 0))，如何限制范围为0~1，img_transformed = np.clip(img_transformed, 0, 1)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#确认图像预处理的结果</span><span class="token comment"># 1. 读取图片</span>image_file_path <span class="token operator">=</span> <span class="token string">'./xxxxxxxxxx/xxx.jpg'</span>img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>image_file_path<span class="token punctuation">)</span>  <span class="token comment"># [高度][宽度][颜色RGB]</span><span class="token comment"># 2.  显示处理前的图片示</span>plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 3. 同时显示预处理前后的图片</span>resize <span class="token operator">=</span> <span class="token number">224</span>mean <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">)</span>std <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">)</span>transform <span class="token operator">=</span> BaseTransform<span class="token punctuation">(</span>resize<span class="token punctuation">,</span> mean<span class="token punctuation">,</span> std<span class="token punctuation">)</span>img_transformed <span class="token operator">=</span> transform<span class="token punctuation">(</span>img<span class="token punctuation">)</span>  <span class="token comment"># torch.Size([3, 224, 224])</span><span class="token comment"># 将 ( 颜色、高度、宽度 ) 转换为 ( 高度、宽度、颜色 )，并将取值范围限制在0~1</span>img_transformed <span class="token operator">=</span> img_transformed<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>img_transformed <span class="token operator">=</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>img_transformed<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>img_transformed<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>实现一个处理输出后结果进行预测的类ILSVRCPredictor()，即实现将VGG16模型1000维的输出结果转换为分类标签的ILSVRCPredictor类。</p><p>从VGG-16模型输出的数值被保存到大小为torch.Size([1,1000])的PyTorch张量中，这里需要将其转换为NumPy变量。因此调用.debatch(),将输出结果从网路中分离出来；然后，对被debatch的张量进行.numpy()调用，将其转换为numpy变量，并用np.argmax()获取最大值的索引。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">ILSVRC_class_index <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./data/imagenet_class_index.json'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 根据输出结果对标签进行预测的后处理类</span><span class="token keyword">class</span> <span class="token class-name">ILSVRCPredictor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    根据ILSVRC数据，从模型的输出结果计算出分类标签    Attributes    ----------    class_index : dictionary           将类的index与标签名关联起来的字典型变量    """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> class_index<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>class_index <span class="token operator">=</span> class_index    <span class="token keyword">def</span> <span class="token function">predict_max</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        获得概率最大的ILSVRC分类标签名        Parameters        ----------        out : torch.Size([1, 1000])            从Net中输出结果        Returns        -------        predicted_label_name : str            预测概率最高的分类标签的名称        """</span>        maxid <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>out<span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment">#str()将数字-&gt;字符，class_index是字典，所以key是字符，故str(),再然后values是一个列表，列表第二个元素是#所分类别的名字,故[1]</span>        predicted_label_name <span class="token operator">=</span> self<span class="token punctuation">.</span>class_index<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>maxid<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> predicted_label_name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>调用已完成学习的VGG开始预测手头的图片啦</p><p>整理一下思路，输入的图片经过BaseTransform()预处理转换后，被作为VGG-16模型的输入数据输入。模型输出的1000维数据又经过ISVRCPredicor的处理，被转换为预测概率最高的分类标签名，并作为最终的输出结果返回。</p><p>注意，在将图片输入PyTorch网络中，需一小批次的形式传递，故使用.unsqueeze_(0),（英语单词非压缩，即扩展）0代表是第一维度，作用就是扩展一个维度，在整体大小不变的情况下，且增大的维度是第一维度（确实就batch_size=1）。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 载入ILSVRC的标签信息，并生成字典型变量</span>ILSVRC_class_index <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./data/imagenet_class_index.json'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 生成ILSVRCPredictor的实例</span>predictor <span class="token operator">=</span> ILSVRCPredictor<span class="token punctuation">(</span>ILSVRC_class_index<span class="token punctuation">)</span><span class="token comment"># 读取输入的图像</span>image_file_path <span class="token operator">=</span> <span class="token string">'./xxxx/xxxx.jpg'</span>img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>image_file_path<span class="token punctuation">)</span>  <span class="token comment"># [ 高度 ][ 宽度 ][ 颜色RGB]</span><span class="token comment"># 完成预处理后，添加批次尺寸的维度</span>transform <span class="token operator">=</span> BaseTransform<span class="token punctuation">(</span>resize<span class="token punctuation">,</span> mean<span class="token punctuation">,</span> std<span class="token punctuation">)</span>  <span class="token comment">#创建预处理类</span>img_transformed <span class="token operator">=</span> transform<span class="token punctuation">(</span>img<span class="token punctuation">)</span>  <span class="token comment"># torch.Size([3, 224, 224])</span>inputs <span class="token operator">=</span> img_transformed<span class="token punctuation">.</span>unsqueeze_<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># torch.Size([1, 3, 224, 224])</span><span class="token comment"># 输入数据到模型中，并将模型的输出转换为标签</span>out <span class="token operator">=</span> net<span class="token punctuation">(</span>inputs<span class="token punctuation">)</span>  <span class="token comment"># torch.Size([1, 1000])</span>result <span class="token operator">=</span> predictor<span class="token punctuation">.</span>predict_max<span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token comment"># 输出预测结果</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"输入图像的预测结果："</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>深度学习入门笔记</title>
      <link href="/2023/10/14/shen-du-xue-xi-ru-men-bi-ji/"/>
      <url>/2023/10/14/shen-du-xue-xi-ru-men-bi-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="激活函数"><a href="#激活函数" class="headerlink" title="激活函数"></a>激活函数</h2><p>activation function :将输入信号的总和转换为输出信号，作用就是决定如何激活输入信号的总和。</p><h3 id="sigmoid-func"><a href="#sigmoid-func" class="headerlink" title="sigmoid func"></a>sigmoid func</h3><p>h(x) = 1 / 1 + exp(-x)</p><h3 id="阶跃函数"><a href="#阶跃函数" class="headerlink" title="阶跃函数"></a>阶跃函数</h3><p>相当于感知机  </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">step_fun</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">if</span> X <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token number">1</span>  <span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token comment">#np的类型</span><span class="token keyword">def</span> <span class="token function">step_fun</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>    y <span class="token operator">=</span> x <span class="token operator">&gt;</span> <span class="token number">0</span>  <span class="token keyword">return</span> y<span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ReLU函数"><a href="#ReLU函数" class="headerlink" title="ReLU函数"></a>ReLU函数</h3><p>Rectified Linear Unit</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">relu</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token keyword">return</span> np<span class="token punctuation">.</span>maximum<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>x<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="nn重要概念"><a href="#nn重要概念" class="headerlink" title="nn重要概念"></a>nn重要概念</h2><p>神经网络内积：<br><img src="/2023/10/14/shen-du-xue-xi-ru-men-bi-ji/20181219152354924.png"><br><img src="/2023/10/14/shen-du-xue-xi-ru-men-bi-ji/2.png"><br>输出层： softmax（）：yk = exp (ak) / exp (a1+a2+…+an)</p>]]></content>
      
      
      <categories>
          
          <category> DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>二叉树遍历(算法)</title>
      <link href="/2023/04/13/er-cha-shu-bian-li-suan-fa/"/>
      <url>/2023/04/13/er-cha-shu-bian-li-suan-fa/</url>
      
        <content type="html"><![CDATA[<h1 id="二叉树遍历"><a href="#二叉树遍历" class="headerlink" title="二叉树遍历"></a>二叉树遍历</h1><p><a href="https://www.acwing.com/problem/content/description/3387/">原题</a><br>思路：树的遍历<br>题意：已知二叉树的前序遍历(带有空节点位置)求中序遍历<br>一边“建树”，一边输出</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cstring&gt;</span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;algorithm&gt;</span></span><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>ch <span class="token operator">==</span> <span class="token char">'#'</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token punctuation">;</span>    <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cout <span class="token operator">&lt;&lt;</span> ch <span class="token operator">&lt;&lt;</span> <span class="token char">' '</span><span class="token punctuation">;</span>    <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
          <category> 二叉树 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法 </tag>
            
            <tag> 二叉树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>动手学深度学习（1）</title>
      <link href="/2023/04/12/dong-shou-xue-shen-du-xue-xi-1/"/>
      <url>/2023/04/12/dong-shou-xue-shen-du-xue-xi-1/</url>
      
        <content type="html"><![CDATA[<h1 id="预备知识"><a href="#预备知识" class="headerlink" title="预备知识"></a>预备知识</h1><h2 id="数据操作"><a href="#数据操作" class="headerlink" title="数据操作"></a>数据操作</h2><p>在PyTorch中，torch.Tensor是存储和变换数据的主要工具。Tensor和NumPy的多维数组非常类似。然而，Tensor提供GPU计算和自动求梯度等更多功能，这些使Tensor更加适合深度学习。</p><p>“tensor”这个单词一般可译作“张量”，张量可以看作是一个多维数组。标量可以看作是0维张量，向量可以看作1维张量，矩阵可以看作是二维张量。</p><h3 id="创建Tensor"><a href="#创建Tensor" class="headerlink" title="创建Tensor"></a>创建Tensor</h3><p>首先导入pytorch</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> torch<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后创建一个5x3的未初始化的Tensor</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>创建一个5x3的随机初始化的Tensor</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>创建一个5x3的long型全0的Tensor</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>输出</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以根据数据创建</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5.5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment"># tensor([5.5000, 3.0000])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>还可以通过现有的Tensor来创建，此方法会默认重用输入Tensor的一些属性，例如数据类型，除非自定义数据类型。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> x<span class="token punctuation">.</span>new_ones<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float64<span class="token punctuation">)</span>  <span class="token comment"># 返回的tensor默认具有相同的torch.dtype和torch.device</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>x <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn_like<span class="token punctuation">(</span>x<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token comment"># 指定新的数据类型</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float64<span class="token punctuation">)</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.6035</span><span class="token punctuation">,</span>  <span class="token number">0.8110</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0451</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">0.8797</span><span class="token punctuation">,</span>  <span class="token number">1.0482</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0445</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.7229</span><span class="token punctuation">,</span>  <span class="token number">2.8663</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5655</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">0.1604</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0254</span><span class="token punctuation">,</span>  <span class="token number">1.0739</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">2.2628</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9175</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2251</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>通过shape或size()来获取Tensor的形状</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token comment">#均为torch.Size([5,3])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>注意：返回的torch.Size其实就是一个tuple, 支持所有tuple的操作。<br><img src="/2023/04/12/dong-shou-xue-shen-du-xue-xi-1/image1.jpg"></p><h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><h4 id="算术操作"><a href="#算术操作" class="headerlink" title="算术操作"></a>算术操作</h4><p>加法形式1</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">y <span class="token operator">=</span> torch<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>加法形式2</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>add<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>还可以指定输出</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">result <span class="token operator">=</span> torch<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>torch<span class="token punctuation">.</span>add<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> out<span class="token operator">=</span>result<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>加法形式3</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># adds x to y</span>y<span class="token punctuation">.</span>add_<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>注：PyTorch操作inplace版本都有后缀_, 例如x.copy_(y), x.t_()</p><h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><p>我们还可以使用类似NumPy的索引操作来访问Tensor的一部分，需要注意的是：索引出来的结果与原数据共享内存，也即修改一个，另一个会跟着修改。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">y <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment">#第一行的，从头到尾</span>y <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 源tensor也被改了</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2023/04/12/dong-shou-xue-shen-du-xue-xi-1/image2.jpg"></p><h4 id="改变形状"><a href="#改变形状" class="headerlink" title="改变形状"></a>改变形状</h4><p>用view()来改变Tensor的形状</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">y <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>z <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># -1所指的维度可以根据其他维度的值推出来</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>输出</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span> torch<span class="token punctuation">.</span>Size<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>注意view()返回的新Tensor与源Tensor虽然可能有不同的size，但是是共享data的，也即更改其中的一个，另外一个也会跟着改变。(顾名思义，view仅仅是改变了对这个张量的观察角度，内部数据并未改变)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token comment"># 也加了1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>输出</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1.6035</span><span class="token punctuation">,</span> <span class="token number">1.8110</span><span class="token punctuation">,</span> <span class="token number">0.9549</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1.8797</span><span class="token punctuation">,</span> <span class="token number">2.0482</span><span class="token punctuation">,</span> <span class="token number">0.9555</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">0.2771</span><span class="token punctuation">,</span> <span class="token number">3.8663</span><span class="token punctuation">,</span> <span class="token number">0.4345</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">1.1604</span><span class="token punctuation">,</span> <span class="token number">0.9746</span><span class="token punctuation">,</span> <span class="token number">2.0739</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3.2628</span><span class="token punctuation">,</span> <span class="token number">0.0825</span><span class="token punctuation">,</span> <span class="token number">0.7749</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1.6035</span><span class="token punctuation">,</span> <span class="token number">1.8110</span><span class="token punctuation">,</span> <span class="token number">0.9549</span><span class="token punctuation">,</span> <span class="token number">1.8797</span><span class="token punctuation">,</span> <span class="token number">2.0482</span><span class="token punctuation">,</span> <span class="token number">0.9555</span><span class="token punctuation">,</span> <span class="token number">0.2771</span><span class="token punctuation">,</span> <span class="token number">3.8663</span><span class="token punctuation">,</span> <span class="token number">0.4345</span><span class="token punctuation">,</span>        <span class="token number">1.1604</span><span class="token punctuation">,</span> <span class="token number">0.9746</span><span class="token punctuation">,</span> <span class="token number">2.0739</span><span class="token punctuation">,</span> <span class="token number">3.2628</span><span class="token punctuation">,</span> <span class="token number">0.0825</span><span class="token punctuation">,</span> <span class="token number">0.7749</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>所以如果我们想返回一个真正新的副本（即不共享data内存）该怎么办呢？Pytorch还提供了一个reshape()可以改变形状，但是此函数并不能保证返回的是其拷贝，所以不推荐使用。推荐先用clone创造一个副本然后再使用view。<a href="https://stackoverflow.com/questions/49643225/whats-the-difference-between-reshape-and-view-in-pytorch">参考此处</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x_cp <span class="token operator">=</span> x<span class="token punctuation">.</span>clone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>x <span class="token operator">-=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x_cp<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>输出</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.6035</span><span class="token punctuation">,</span>  <span class="token number">0.8110</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0451</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">0.8797</span><span class="token punctuation">,</span>  <span class="token number">1.0482</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0445</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.7229</span><span class="token punctuation">,</span>  <span class="token number">2.8663</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5655</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">0.1604</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0254</span><span class="token punctuation">,</span>  <span class="token number">1.0739</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span> <span class="token number">2.2628</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.9175</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.2251</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1.6035</span><span class="token punctuation">,</span> <span class="token number">1.8110</span><span class="token punctuation">,</span> <span class="token number">0.9549</span><span class="token punctuation">,</span> <span class="token number">1.8797</span><span class="token punctuation">,</span> <span class="token number">2.0482</span><span class="token punctuation">,</span> <span class="token number">0.9555</span><span class="token punctuation">,</span> <span class="token number">0.2771</span><span class="token punctuation">,</span> <span class="token number">3.8663</span><span class="token punctuation">,</span> <span class="token number">0.4345</span><span class="token punctuation">,</span>        <span class="token number">1.1604</span><span class="token punctuation">,</span> <span class="token number">0.9746</span><span class="token punctuation">,</span> <span class="token number">2.0739</span><span class="token punctuation">,</span> <span class="token number">3.2628</span><span class="token punctuation">,</span> <span class="token number">0.0825</span><span class="token punctuation">,</span> <span class="token number">0.7749</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>使用clone还有一个好处是会被记录在计算图中，即梯度回传到副本时也会传到源Tensor。<br>另外一个常用的函数就是item(), 它可以将一个标量Tensor转换成一个Python number：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>输出</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2.3466</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token number">2.3466382026672363</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="线性代数"><a href="#线性代数" class="headerlink" title="线性代数"></a>线性代数</h4><p><img src="/2023/04/12/dong-shou-xue-shen-du-xue-xi-1/image3.jpg"><br>PyTorch中的Tensor支持超过一百种操作，包括转置、索引、切片、数学运算、线性代数、随机数等等，可参考<a href="https://pytorch.org/docs/stable/tensors.html">官方文档</a></p><h4 id="广播机制"><a href="#广播机制" class="headerlink" title="广播机制"></a>广播机制</h4><p>(之前都是相同形状运算)当对两个形状不同的Tensor按元素运算时，可能会触发广播（broadcasting）机制：先适当复制元素使这两个Tensor形状相同后再按元素运算。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>y <span class="token operator">=</span> torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>由于x和y分别是1行2列和3行1列的矩阵，如果要计算x + y，那么x中第一行的2个元素被广播（复制）到了第二行和第三行，而y中第一列的3个元素被广播（复制）到了第二列。如此，就可以对2个3行2列的矩阵按元素相加。</p><h3 id="运算的内存开销"><a href="#运算的内存开销" class="headerlink" title="运算的内存开销"></a>运算的内存开销</h3><p>索引操作是不会开辟新内存的，而像y = x + y这样的运算是会新开内存的，然后将y指向新内存。为了演示这一点，我们可以使用Python自带的id函数：如果两个实例的ID一致，那么它们所对应的内存地址相同；反之则不同。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>y <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>id_before <span class="token operator">=</span> <span class="token builtin">id</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>y <span class="token operator">=</span> y <span class="token operator">+</span> x<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">==</span> id_before<span class="token punctuation">)</span> <span class="token comment"># False </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果想指定结果到原来的y的内存，我们可以使用前面介绍的索引来进行替换操作。在下面的例子中，我们把x + y的结果通过[:]写进y对应的内存中。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>y <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>id_before <span class="token operator">=</span> <span class="token builtin">id</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> y <span class="token operator">+</span> x<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">==</span> id_before<span class="token punctuation">)</span> <span class="token comment"># True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>我们还可以使用运算符全名函数中的out参数或者自加运算符+=(也即add_())达到上述效果，例如torch.add(x, y, out=y)和y += x(y.add_(x))。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>y <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>id_before <span class="token operator">=</span> <span class="token builtin">id</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>torch<span class="token punctuation">.</span>add<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> out<span class="token operator">=</span>y<span class="token punctuation">)</span> <span class="token comment"># y += x, y.add_(x)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">==</span> id_before<span class="token punctuation">)</span> <span class="token comment"># True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注：虽然view返回的Tensor与源Tensor是共享data的，但是依然是一个新的Tensor（因为Tensor除了包含data外还有一些其他属性），二者id（内存地址）并不一致。</p><h3 id="Tensor和Numpy相互转换"><a href="#Tensor和Numpy相互转换" class="headerlink" title="Tensor和Numpy相互转换"></a>Tensor和Numpy相互转换</h3><p>我们很容易用numpy()和from_numpy()将Tensor和NumPy中的数组相互转换。但是需要注意的一点是： 这两个函数所产生的的Tensor和NumPy中的数组共享相同的内存（所以他们之间的转换很快），改变其中一个时另一个也会改变！！！</p><blockquote><p>还有一个常用的将NumPy中的array转换成Tensor的方法就是torch.tensor(), 需要注意的是，此方法总是会进行数据拷贝（就会消耗更多的时间和空间），所以返回的Tensor和原来的数据不再共享内存。</p></blockquote><h4 id="Tensor转Numpy"><a href="#Tensor转Numpy" class="headerlink" title="Tensor转Numpy"></a>Tensor转Numpy</h4><p>使用numpy()将Tensor转换成NumPy数组:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>b <span class="token operator">=</span> a<span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>a <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>b <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">1.</span> <span class="token number">1.</span> <span class="token number">1.</span> <span class="token number">1.</span> <span class="token number">1.</span><span class="token punctuation">]</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2.</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">2.</span> <span class="token number">2.</span> <span class="token number">2.</span> <span class="token number">2.</span> <span class="token number">2.</span><span class="token punctuation">]</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">3.</span> <span class="token number">3.</span> <span class="token number">3.</span> <span class="token number">3.</span> <span class="token number">3.</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="NumPy数组转Tensor"><a href="#NumPy数组转Tensor" class="headerlink" title="NumPy数组转Tensor"></a>NumPy数组转Tensor</h4><p>使用from_numpy()将NumPy数组转换成Tensor:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npa <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>b <span class="token operator">=</span> torch<span class="token punctuation">.</span>from_numpy<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>a <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>b <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token number">1.</span> <span class="token number">1.</span> <span class="token number">1.</span> <span class="token number">1.</span> <span class="token number">1.</span><span class="token punctuation">]</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">,</span> <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float64<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2.</span> <span class="token number">2.</span> <span class="token number">2.</span> <span class="token number">2.</span> <span class="token number">2.</span><span class="token punctuation">]</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2.</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">,</span> <span class="token number">2.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float64<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3.</span> <span class="token number">3.</span> <span class="token number">3.</span> <span class="token number">3.</span> <span class="token number">3.</span><span class="token punctuation">]</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float64<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>所有在CPU上的Tensor（除了CharTensor）都支持与NumPy数组相互转换。</p><p>此外上面提到还有一个常用的方法就是直接用torch.tensor()将NumPy数组转换成Tensor，需要注意的是该方法总是会进行数据拷贝，返回的Tensor和原来的数据不再共享内存。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">c <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>a<span class="token punctuation">)</span>a <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>输出</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token number">4.</span> <span class="token number">4.</span> <span class="token number">4.</span> <span class="token number">4.</span> <span class="token number">4.</span><span class="token punctuation">]</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">,</span> <span class="token number">3.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float64<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Tensor-on-GPU"><a href="#Tensor-on-GPU" class="headerlink" title="Tensor on GPU"></a>Tensor on GPU</h3><p>方法to()可以将CPU和GPU之间相互移动</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 以下代码只有在PyTorch GPU版本上才会执行</span><span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    device <span class="token operator">=</span> torch<span class="token punctuation">.</span>device<span class="token punctuation">(</span><span class="token string">"cuda"</span><span class="token punctuation">)</span>          <span class="token comment"># GPU</span>    y <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>x<span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span>  <span class="token comment"># 直接创建一个在GPU上的Tensor</span>    x <span class="token operator">=</span> x<span class="token punctuation">.</span>to<span class="token punctuation">(</span>device<span class="token punctuation">)</span>                       <span class="token comment"># 等价于 .to("cuda")</span>    z <span class="token operator">=</span> x <span class="token operator">+</span> y    <span class="token keyword">print</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span>to<span class="token punctuation">(</span><span class="token string">"cpu"</span><span class="token punctuation">,</span> torch<span class="token punctuation">.</span>double<span class="token punctuation">)</span><span class="token punctuation">)</span>       <span class="token comment"># to()还可以同时更改数据类型</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 《动手学深度学习》自学笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编译原理3.29</title>
      <link href="/2023/03/29/bian-yi-3-29/"/>
      <url>/2023/03/29/bian-yi-3-29/</url>
      
        <content type="html"><![CDATA[<h1 id="第一章-引论"><a href="#第一章-引论" class="headerlink" title="第一章 引论"></a>第一章 引论</h1><h2 id="1-1程序的翻译"><a href="#1-1程序的翻译" class="headerlink" title="1.1程序的翻译"></a>1.1程序的翻译</h2><p>翻译程序： 源语言-&gt;与之等价的目标语言<br>两种方式：1、编译 2、解释  </p><h3 id="编译方式"><a href="#编译方式" class="headerlink" title="编译方式"></a>编译方式</h3><p>编译方式是一种分阶段进行的方式<br>翻译阶段：高级语言或汇编语言程序-&gt;汇编语言或机器语言的目标程序<br>运行阶段：输入数据–目标程序&amp;系统子程序–&gt;运行结果<br>特点：  </p><ul><li>源程序的执行需要分阶段  <ul><li>如果目标程序是机器语言程序，两大阶段：编译阶段和运行阶段。</li><li>如果目标程序是汇编语言程序，三大阶段：编译阶段、汇编阶段和运行阶段。</li></ul></li><li>生成了目标代码，且可以多次执行。</li></ul><p>说明：  </p><ul><li>生成的目标程序<u>不一定</u>是机器语言的程序，也有可能是汇编语言程序；</li><li>编译程序与<u>具体的机器和语言有关</u>，即任何一个具体的编译程序都是某一特定类型的计算机系统中关于某一特定语言的编译程序；</li><li>对编译程序而言，<u>源程序</u>是输入数据，<u>目标程序</u>是输出结果</li></ul><h3 id="解释方式"><a href="#解释方式" class="headerlink" title="解释方式"></a>解释方式</h3><p>解释程序将按源程序中<del>语句的动态顺序</del>，逐句地进行分析解释，并<del>立即</del>予以<del>执行</del>。<br>特点：</p><ul><li>不生成目标代码，直接执行源程序本身。与前者方式的<del>根本区别</del>。</li><li>都需要进行词法、语法、语义分析</li><li>更灵活，交互方便，节省空间</li><li>效率低（时间开销、空间开销）</li></ul><p><img src="/2023/03/29/bian-yi-3-29/images.jpg"></p><h2 id="1-2编译程序的工作过程"><a href="#1-2编译程序的工作过程" class="headerlink" title="1.2编译程序的工作过程"></a>1.2编译程序的工作过程</h2><ul><li>词法分析</li><li>语法分析</li><li>语义分析和中间代码生成</li><li>中间代码优化</li><li>目标代码生成</li></ul><h3 id="词法分析"><a href="#词法分析" class="headerlink" title="词法分析"></a>词法分析</h3><p>依据语言<font color="red">词法规则</font>，分析由字符组成的源程序，把它识别为一个一个具有独立意义的<font color="red">最小语法单位</font>，即“<font color="red">单词</font>”，并识别出与其相关的属性（如是标识符还是界限符，or数..）再转换成<font color="red">长度上统一</font>的标准形式（这个形式既刻画单词本身，又刻画了它具有的属性，称为<font color="red">属性字</font>），以供其他部分使用。  </p><ul><li>扫描源程序的字符串，识别单词（关键字、标识符、常量、运算符、界限符）</li></ul><p>eg:<br><img src="/2023/03/29/bian-yi-3-29/images1.jpg"></p><p>属性字： &lt;类别号class，自身值value&gt;</p><h3 id="语法分析"><a href="#语法分析" class="headerlink" title="语法分析"></a>语法分析</h3><p>依据<font color="red">语法规则</font>，逐一分析词法分析时得到的单词，把单词串分解成各类语法单位，即确定<font color="red">它们是怎样组成和语句，以及说明语句又是怎样组成程序的</font>。分析时如发现有不合语法规则的地方，便将出错的位置及出错性质打印报告程序员。如无语法错误，则用另一种中间形式给出正确的语法结构，供下一阶段分析使用。</p><h3 id="语义分析"><a href="#语义分析" class="headerlink" title="语义分析"></a>语义分析</h3><p>依据语言的语义规则对语法分析得到的语法结构进行静态语义检查（确定类型、类型和运算合法性检查、识别含义与相 应的语义处理及其它一些静态语义检查），并用另一种内部形式表示出来，或者直接用目标语言表示出来。<br>凡在编译时可以确定的内容称为“静态”的；凡必须推迟 到程序运行时才能确定的内容称为“动态”的</p><h3 id="代码优化"><a href="#代码优化" class="headerlink" title="代码优化"></a>代码优化</h3><p>依据程序的等价变换规则，尽量压缩目标程序运行所需的 时间和所占的存储空间，以提高目标程序的质量。<br>优化的是中间代码/目标代码的质量，而非编译程序的质量</p><h3 id="代码生成"><a href="#代码生成" class="headerlink" title="代码生成"></a>代码生成</h3><p>如果语义分析时把源程序表示成中间形式而不是表示成目标指令，则由本部分完成从中间形式到目标指令的转换。如果语义分析时，已直接生成目标指令，则无需另外再做代码生成工作。<br>目标指令可能是绝对指令代码，或可重新定位的指令代码 或汇编指令代码。该阶段的工作有赖于硬件系统结构和机器指令含义。</p><h3 id="表格管理"><a href="#表格管理" class="headerlink" title="表格管理"></a>表格管理</h3><p>登记源程序中出现的每个名字以及名字的各种属性。有些名字的属性需要在各个阶段才能填入。<br><img src="/2023/03/29/bian-yi-3-29/images2.jpg"></p><h3 id="出错处理"><a href="#出错处理" class="headerlink" title="出错处理"></a>出错处理</h3><p>源程序中的错误有语法错误和语义错误两种。</p><p>语法错误：源程序中不符合语法（或词法）规则的错误，它们可在词法分析或语法分析时检测出来。</p><p>语义错误：源程序中不符合语义规则的错误，一般在语义分析时检测出来，有的语义错误要在运行时才能检测出来。通常包括：说明错误、作用域错误、类型不一致等等。</p><h2 id="1-3编译程序的结构"><a href="#1-3编译程序的结构" class="headerlink" title="1.3编译程序的结构"></a>1.3编译程序的结构</h2><p><img src="/2023/03/29/bian-yi-3-29/images3.jpg"></p><h2 id="1-4编译程序的组织形式"><a href="#1-4编译程序的组织形式" class="headerlink" title="1.4编译程序的组织形式"></a>1.4编译程序的组织形式</h2><h3 id="遍（趟，趟程）"><a href="#遍（趟，趟程）" class="headerlink" title="遍（趟，趟程）"></a>遍（趟，趟程）</h3><p>所谓一趟或一遍是指一个编译程序在编译时刻把源程序或源 程序的等价物（中间程序）从头到尾扫描一遍并转换成另一紧邻的 等价物的全过程。</p><p>根据编译程序在完成翻译任务的过程中需要对源程序或其中间等价物扫描的遍数，可以把编译程序分为单遍扫描的编译程序 （只需扫描一遍）和多遍扫描的编译程序（需扫描多遍）。<br><img src="/2023/03/29/bian-yi-3-29/images4.jpg"></p><p>多遍的特点：<br>优点：</p><ul><li>节省内存空间</li><li>提高目标程序质量</li><li>缩短Compiler的开发周期</li></ul><p>缺点：  </p><ul><li>重复性工作</li><li>延长了编译时间，降低了编译效率</li></ul><p>并非单遍/多遍一定就好，视情况而定。<br>选择编译的“遍”数的原则：  </p><ul><li>语言的大小、结构</li><li>机器的规模</li><li>设计的目的（如：编译速度、目标程序的运行速度）</li><li>设计人员素质多少</li></ul><h3 id="编译的前端和后端"><a href="#编译的前端和后端" class="headerlink" title="编译的前端和后端"></a>编译的前端和后端</h3><ul><li>前端主要由与源语言有关但与目标机器无关的那些部分组成, 如词法分析、语法分析、语义分析与中间代码生成及部分代码优 化工作。  </li><li>后端主要包括编译中与目标机器有关的那些部分，如与目标 机有关的代码优化和目标代码生成等。后端不依赖于源语言而仅 依赖于中间语言。<br><img src="/2023/03/29/bian-yi-3-29/images5.jpg"></li></ul><p><img src="/2023/03/29/bian-yi-3-29/images6.jpg"></p><h2 id="1-5编译程序的构造"><a href="#1-5编译程序的构造" class="headerlink" title="1.5编译程序的构造"></a>1.5编译程序的构造</h2><h3 id="高级语言的自编译性高级语言的自编译性"><a href="#高级语言的自编译性高级语言的自编译性" class="headerlink" title="高级语言的自编译性高级语言的自编译性"></a>高级语言的自编译性高级语言的自编译性</h3><p>构造编译程序可以用机器言语、汇编语言和高级语言<br>高级语言的自编译性：一个语言可以用来编写自己的编 译程序。<br><img src="/2023/03/29/bian-yi-3-29/images7.jpg"></p><p><img src="/2023/03/29/bian-yi-3-29/images8.jpg"></p><h3 id="编译的自展技术"><a href="#编译的自展技术" class="headerlink" title="编译的自展技术"></a>编译的自展技术</h3><p>即通过一系列自展途径而形成编译程序的过程。<br>先对语言的核心部分构造一个小小编译程序（可用低级语 言实现），再以它为工具构造一个能够编译更多语言成分的较大编译程序。如此扩展下去，越滚越大，最后形成所期望的整个编译程序。<br><img src="/2023/03/29/bian-yi-3-29/images9.jpg"></p><h3 id="编译的移植"><a href="#编译的移植" class="headerlink" title="编译的移植"></a>编译的移植</h3><p>即将一个机器（宿主机）上的一个具有自编译性的高级语 言编译程序移植到另一个机器（目标机）上。<br>利用A机器上的高级语言L编写能在B机器上运行的高级语言L的编译程序。<br><img src="/2023/03/29/bian-yi-3-29/images10.jpg"></p><p><img src="/2023/03/29/bian-yi-3-29/images11.jpg"></p><h3 id="编译程序的自动化"><a href="#编译程序的自动化" class="headerlink" title="编译程序的自动化"></a>编译程序的自动化</h3><p><img src="/2023/03/29/bian-yi-3-29/images12.jpg"></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><ul><li>什么是编译程序</li><li>编译方式的特点</li><li>解释方式的特点</li><li>编译方式与解释方式的根本区别</li><li>编译程序的工作过程</li><li>编译程序的结构</li><li>遍与编译程序的组织形式</li><li>编译程序的构造方法</li></ul>]]></content>
      
      
      <categories>
          
          <category> CP notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CP notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2023/03/28/hello-world/"/>
      <url>/2023/03/28/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
